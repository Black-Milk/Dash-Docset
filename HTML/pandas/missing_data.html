

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Working with missing data &mdash; pandas 0.11.1.dev-36c1263 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.11.1.dev-36c1263',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pandas 0.11.1.dev-36c1263 documentation" href="index.html" />
    <link rel="next" title="Group By: split-apply-combine" href="groupby.html" />
    <link rel="prev" title="Computational tools" href="computation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="groupby.html" title="Group By: split-apply-combine"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="computation.html" title="Computational tools"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pandas 0.11.1.dev-36c1263 documentation</a> &raquo;</li> 
      </ul>
    </div>
<div class="content-wrapper">
    <div class="content">
        <div class="document">
            <div class="sphinxsidebar">
                <h3>Table Of Contents</h3>
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">What&#8217;s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Package overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="10min.html">10 Minutes to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsintro.html">Intro to Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Essential Basic Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexing.html">Indexing and Selecting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="computation.html">Computational tools</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Working with missing data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#missing-data-basics">Missing data basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#when-why-does-data-become-missing">When / why does data become missing?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#values-considered-missing">Values considered &#8220;missing&#8221;</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#datetimes">Datetimes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculations-with-missing-data">Calculations with missing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#na-values-in-groupby">NA values in GroupBy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cleaning-filling-missing-data">Cleaning / filling missing data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#filling-missing-values-fillna">Filling missing values: fillna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dropping-axis-labels-with-missing-data-dropna">Dropping axis labels with missing data: dropna</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interpolation">Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#replacing-generic-values">Replacing Generic Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#string-regular-expression-replacement">String/Regular Expression Replacement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numeric-replacement">Numeric Replacement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#missing-data-casting-rules-and-indexing">Missing data casting rules and indexing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="groupby.html">Group By: split-apply-combine</a></li>
<li class="toctree-l1"><a class="reference internal" href="merging.html">Merge, join, and concatenate</a></li>
<li class="toctree-l1"><a class="reference internal" href="reshaping.html">Reshaping and Pivot Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">Time Series / Date functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Plotting with matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="rplot.html">Trellis plotting interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO Tools (Text, CSV, HDF5, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">Sparse data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="gotchas.html">Caveats and Gotchas</a></li>
<li class="toctree-l1"><a class="reference internal" href="r_interface.html">rpy2 / R interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="related.html">Related Python libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_r.html">Comparison with R / R libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Notes</a></li>
</ul>

                <h3 style="margin-top: 1.5em;">Search</h3>

                <form class="search" action="search.html" method="get">
                    <input type="text" name="q" size="18"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>

                <p>

                <p>
                    <script type="text/javascript"
                            src="http://www.ohloh.net/p/482908/widgets/project_partner_badge.js"></script>
                </p>
            </div>
             
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body">
                        
  <div class="section" id="working-with-missing-data">
<span id="missing-data"></span><h1>Working with missing data<a class="headerlink" href="#working-with-missing-data" title="Permalink to this headline">¶</a></h1>
<p>In this section, we will discuss missing (also referred to as NA) values in
pandas.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The choice of using <tt class="docutils literal"><span class="pre">NaN</span></tt> internally to denote missing data was largely
for simplicity and performance reasons. It differs from the MaskedArray
approach of, for example, <tt class="xref py py-mod docutils literal"><span class="pre">scikits.timeseries</span></tt>. We are hopeful that
NumPy will soon be able to provide a native NA type solution (similar to R)
performant enough to be used in pandas.</p>
</div>
<p>See the <a class="reference internal" href="cookbook.html#cookbook-missing-data"><em>cookbook</em></a> for some advanced strategies</p>
<div class="section" id="missing-data-basics">
<h2>Missing data basics<a class="headerlink" href="#missing-data-basics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="when-why-does-data-become-missing">
<h3>When / why does data become missing?<a class="headerlink" href="#when-why-does-data-become-missing" title="Permalink to this headline">¶</a></h3>
<p>Some might quibble over our usage of <em>missing</em>. By &#8220;missing&#8221; we simply mean
<strong>null</strong> or &#8220;not present for whatever reason&#8221;. Many data sets simply arrive with
missing data, either because it exists and was not collected or it never
existed. For example, in a collection of financial time series, some of the time
series might start on different dates. Thus, values prior to the start date
would generally be marked as missing.</p>
<p>In pandas, one of the most common ways that missing data is <strong>introduced</strong> into
a data set is by reindexing. For example</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1444]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;h&#39;</span><span class="p">],</span>
<span class="gp">   ......:</span>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;three&#39;</span><span class="p">])</span>
<span class="gp">   ......:</span> 

<span class="gp">In [1445]: </span><span class="n">df</span><span class="p">[</span><span class="s">&#39;four&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;bar&#39;</span>

<span class="gp">In [1446]: </span><span class="n">df</span><span class="p">[</span><span class="s">&#39;five&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="gp">In [1447]: </span><span class="n">df</span>

<span class="go">        one       two     three four   five</span>
<span class="go">a  0.059117  1.138469 -2.400634  bar   True</span>
<span class="go">c -0.280853  0.025653 -1.386071  bar  False</span>
<span class="go">e  0.863937  0.252462  1.500571  bar   True</span>
<span class="go">f  1.053202 -2.338595 -0.374279  bar   True</span>
<span class="go">h -2.359958 -1.157886 -0.551865  bar  False</span>

<span class="gp">In [1448]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="s">&#39;e&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;g&#39;</span><span class="p">,</span> <span class="s">&#39;h&#39;</span><span class="p">])</span>

<span class="gp">In [1449]: </span><span class="n">df2</span>

<span class="go">        one       two     three four   five</span>
<span class="go">a  0.059117  1.138469 -2.400634  bar   True</span>
<span class="go">b       NaN       NaN       NaN  NaN    NaN</span>
<span class="go">c -0.280853  0.025653 -1.386071  bar  False</span>
<span class="go">d       NaN       NaN       NaN  NaN    NaN</span>
<span class="go">e  0.863937  0.252462  1.500571  bar   True</span>
<span class="go">f  1.053202 -2.338595 -0.374279  bar   True</span>
<span class="go">g       NaN       NaN       NaN  NaN    NaN</span>
<span class="go">h -2.359958 -1.157886 -0.551865  bar  False</span>
</pre></div>
</div>
</div>
<div class="section" id="values-considered-missing">
<h3>Values considered &#8220;missing&#8221;<a class="headerlink" href="#values-considered-missing" title="Permalink to this headline">¶</a></h3>
<p>As data comes in many shapes and forms, pandas aims to be flexible with regard
to handling missing data. While <tt class="docutils literal"><span class="pre">NaN</span></tt> is the default missing value marker for
reasons of computational speed and convenience, we need to be able to easily
detect this value with data of different types: floating point, integer,
boolean, and general object. In many cases, however, the Python <tt class="docutils literal"><span class="pre">None</span></tt> will
arise and we wish to also consider that &#8220;missing&#8221; or &#8220;null&#8221;.</p>
<p>Until recently, for legacy reasons <tt class="docutils literal"><span class="pre">inf</span></tt> and <tt class="docutils literal"><span class="pre">-inf</span></tt> were also
considered to be &#8220;null&#8221; in computations. This is no longer the case by
default; use the <tt class="docutils literal"><span class="pre">mode.use_inf_as_null</span></tt> option to recover it.</p>
<p id="missing-isnull">To make detecting missing values easier (and across different array dtypes),
pandas provides the <a class="reference internal" href="generated/pandas.core.common.isnull.html#pandas.core.common.isnull" title="pandas.core.common.isnull"><tt class="xref py py-func docutils literal"><span class="pre">isnull()</span></tt></a> and
<a class="reference internal" href="generated/pandas.core.common.notnull.html#pandas.core.common.notnull" title="pandas.core.common.notnull"><tt class="xref py py-func docutils literal"><span class="pre">notnull()</span></tt></a> functions, which are also methods on
<tt class="docutils literal"><span class="pre">Series</span></tt> objects:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1450]: </span><span class="n">df2</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">]</span>

<span class="go">a    0.059117</span>
<span class="go">b         NaN</span>
<span class="go">c   -0.280853</span>
<span class="go">d         NaN</span>
<span class="go">e    0.863937</span>
<span class="go">f    1.053202</span>
<span class="go">g         NaN</span>
<span class="go">h   -2.359958</span>
<span class="go">Name: one, dtype: float64</span>

<span class="gp">In [1451]: </span><span class="n">isnull</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">])</span>

<span class="go">a    False</span>
<span class="go">b     True</span>
<span class="go">c    False</span>
<span class="go">d     True</span>
<span class="go">e    False</span>
<span class="go">f    False</span>
<span class="go">g     True</span>
<span class="go">h    False</span>
<span class="go">Name: one, dtype: bool</span>

<span class="gp">In [1452]: </span><span class="n">df2</span><span class="p">[</span><span class="s">&#39;four&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span>

<span class="go">a     True</span>
<span class="go">b    False</span>
<span class="go">c     True</span>
<span class="go">d    False</span>
<span class="go">e     True</span>
<span class="go">f     True</span>
<span class="go">g    False</span>
<span class="go">h     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p><strong>Summary:</strong> <tt class="docutils literal"><span class="pre">NaN</span></tt> and <tt class="docutils literal"><span class="pre">None</span></tt> (in object arrays) are considered
missing by the <tt class="docutils literal"><span class="pre">isnull</span></tt> and <tt class="docutils literal"><span class="pre">notnull</span></tt> functions. <tt class="docutils literal"><span class="pre">inf</span></tt> and
<tt class="docutils literal"><span class="pre">-inf</span></tt> are no longer considered missing by default.</p>
</div>
</div>
<div class="section" id="datetimes">
<h2>Datetimes<a class="headerlink" href="#datetimes" title="Permalink to this headline">¶</a></h2>
<p>For datetime64[ns] types, <tt class="docutils literal"><span class="pre">NaT</span></tt> represents missing values. This is a pseudo-native
sentinal value that can be represented by numpy in a singular dtype (datetime64[ns]).
Pandas objects provide intercompatibility between <tt class="docutils literal"><span class="pre">NaT</span></tt> and <tt class="docutils literal"><span class="pre">NaN</span></tt>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1453]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [1454]: </span><span class="n">df2</span><span class="p">[</span><span class="s">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Timestamp</span><span class="p">(</span><span class="s">&#39;20120101&#39;</span><span class="p">)</span>

<span class="gp">In [1455]: </span><span class="n">df2</span>

<span class="go">        one       two     three four   five           timestamp</span>
<span class="go">a  0.059117  1.138469 -2.400634  bar   True 2012-01-01 00:00:00</span>
<span class="go">c -0.280853  0.025653 -1.386071  bar  False 2012-01-01 00:00:00</span>
<span class="go">e  0.863937  0.252462  1.500571  bar   True 2012-01-01 00:00:00</span>
<span class="go">f  1.053202 -2.338595 -0.374279  bar   True 2012-01-01 00:00:00</span>
<span class="go">h -2.359958 -1.157886 -0.551865  bar  False 2012-01-01 00:00:00</span>

<span class="gp">In [1456]: </span><span class="n">df2</span><span class="o">.</span><span class="n">ix</span><span class="p">[[</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;h&#39;</span><span class="p">],[</span><span class="s">&#39;one&#39;</span><span class="p">,</span><span class="s">&#39;timestamp&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [1457]: </span><span class="n">df2</span>

<span class="go">        one       two     three four   five           timestamp</span>
<span class="go">a       NaN  1.138469 -2.400634  bar   True                 NaT</span>
<span class="go">c       NaN  0.025653 -1.386071  bar  False                 NaT</span>
<span class="go">e  0.863937  0.252462  1.500571  bar   True 2012-01-01 00:00:00</span>
<span class="go">f  1.053202 -2.338595 -0.374279  bar   True 2012-01-01 00:00:00</span>
<span class="go">h       NaN -1.157886 -0.551865  bar  False                 NaT</span>

<span class="gp">In [1458]: </span><span class="n">df2</span><span class="o">.</span><span class="n">get_dtype_counts</span><span class="p">()</span>

<span class="go">bool              1</span>
<span class="go">datetime64[ns]    1</span>
<span class="go">float64           3</span>
<span class="go">object            1</span>
<span class="go">dtype: int64</span>
</pre></div>
</div>
</div>
<div class="section" id="calculations-with-missing-data">
<h2>Calculations with missing data<a class="headerlink" href="#calculations-with-missing-data" title="Permalink to this headline">¶</a></h2>
<p>Missing values propagate naturally through arithmetic operations between pandas
objects.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1459]: </span><span class="n">a</span>

<span class="go">        one       two</span>
<span class="go">a       NaN  1.138469</span>
<span class="go">c       NaN  0.025653</span>
<span class="go">e  0.863937  0.252462</span>
<span class="go">f  1.053202 -2.338595</span>
<span class="go">h  1.053202 -1.157886</span>

<span class="gp">In [1460]: </span><span class="n">b</span>

<span class="go">        one       two     three</span>
<span class="go">a       NaN  1.138469 -2.400634</span>
<span class="go">c       NaN  0.025653 -1.386071</span>
<span class="go">e  0.863937  0.252462  1.500571</span>
<span class="go">f  1.053202 -2.338595 -0.374279</span>
<span class="go">h       NaN -1.157886 -0.551865</span>

<span class="gp">In [1461]: </span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="go">        one  three       two</span>
<span class="go">a       NaN    NaN  2.276938</span>
<span class="go">c       NaN    NaN  0.051306</span>
<span class="go">e  1.727874    NaN  0.504923</span>
<span class="go">f  2.106405    NaN -4.677190</span>
<span class="go">h       NaN    NaN -2.315772</span>
</pre></div>
</div>
<p>The descriptive statistics and computational methods discussed in the
<a class="reference internal" href="basics.html#basics-stats"><em>data structure overview</em></a> (and listed <a class="reference internal" href="api.html#api-series-stats"><em>here</em></a> and <a class="reference internal" href="api.html#api-dataframe-stats"><em>here</em></a>) are all written to
account for missing data. For example:</p>
<blockquote>
<div><ul class="simple">
<li>When summing data, NA (missing) values will be treated as zero</li>
<li>If the data are all NA, the result will be NA</li>
<li>Methods like <strong>cumsum</strong> and <strong>cumprod</strong> ignore NA values, but preserve them
in the resulting arrays</li>
</ul>
</div></blockquote>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1462]: </span><span class="n">df</span>

<span class="go">        one       two     three</span>
<span class="go">a       NaN  1.138469 -2.400634</span>
<span class="go">c       NaN  0.025653 -1.386071</span>
<span class="go">e  0.863937  0.252462  1.500571</span>
<span class="go">f  1.053202 -2.338595 -0.374279</span>
<span class="go">h       NaN -1.157886 -0.551865</span>

<span class="gp">In [1463]: </span><span class="n">df</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">1.917139050150438</span>

<span class="gp">In [1464]: </span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="go">a   -0.631082</span>
<span class="go">c   -0.680209</span>
<span class="go">e    0.872323</span>
<span class="go">f   -0.553224</span>
<span class="go">h   -0.854876</span>
<span class="go">dtype: float64</span>

<span class="gp">In [1465]: </span><span class="n">df</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

<span class="go">        one       two     three</span>
<span class="go">a       NaN  1.138469 -2.400634</span>
<span class="go">c       NaN  1.164122 -3.786705</span>
<span class="go">e  0.863937  1.416584 -2.286134</span>
<span class="go">f  1.917139 -0.922011 -2.660413</span>
<span class="go">h       NaN -2.079897 -3.212278</span>
</pre></div>
</div>
<div class="section" id="na-values-in-groupby">
<h3>NA values in GroupBy<a class="headerlink" href="#na-values-in-groupby" title="Permalink to this headline">¶</a></h3>
<p>NA groups in GroupBy are automatically excluded. This behavior is consistent
with R, for example.</p>
</div>
</div>
<div class="section" id="cleaning-filling-missing-data">
<h2>Cleaning / filling missing data<a class="headerlink" href="#cleaning-filling-missing-data" title="Permalink to this headline">¶</a></h2>
<p>pandas objects are equipped with various data manipulation methods for dealing
with missing data.</p>
<div class="section" id="filling-missing-values-fillna">
<span id="missing-data-fillna"></span><h3>Filling missing values: fillna<a class="headerlink" href="#filling-missing-values-fillna" title="Permalink to this headline">¶</a></h3>
<p>The <strong>fillna</strong> function can &#8220;fill in&#8221; NA values with non-null data in a couple
of ways, which we illustrate:</p>
<p><strong>Replace NA with a scalar value</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1466]: </span><span class="n">df2</span>

<span class="go">        one       two     three four   five           timestamp</span>
<span class="go">a       NaN  1.138469 -2.400634  bar   True                 NaT</span>
<span class="go">c       NaN  0.025653 -1.386071  bar  False                 NaT</span>
<span class="go">e  0.863937  0.252462  1.500571  bar   True 2012-01-01 00:00:00</span>
<span class="go">f  1.053202 -2.338595 -0.374279  bar   True 2012-01-01 00:00:00</span>
<span class="go">h       NaN -1.157886 -0.551865  bar  False                 NaT</span>

<span class="gp">In [1467]: </span><span class="n">df2</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="go">        one       two     three four   five           timestamp</span>
<span class="go">a  0.000000  1.138469 -2.400634  bar   True 1970-01-01 00:00:00</span>
<span class="go">c  0.000000  0.025653 -1.386071  bar  False 1970-01-01 00:00:00</span>
<span class="go">e  0.863937  0.252462  1.500571  bar   True 2012-01-01 00:00:00</span>
<span class="go">f  1.053202 -2.338595 -0.374279  bar   True 2012-01-01 00:00:00</span>
<span class="go">h  0.000000 -1.157886 -0.551865  bar  False 1970-01-01 00:00:00</span>

<span class="gp">In [1468]: </span><span class="n">df2</span><span class="p">[</span><span class="s">&#39;four&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s">&#39;missing&#39;</span><span class="p">)</span>

<span class="go">a    bar</span>
<span class="go">c    bar</span>
<span class="go">e    bar</span>
<span class="go">f    bar</span>
<span class="go">h    bar</span>
<span class="go">Name: four, dtype: object</span>
</pre></div>
</div>
<p><strong>Fill gaps forward or backward</strong></p>
<p>Using the same filling arguments as <a class="reference internal" href="basics.html#basics-reindexing"><em>reindexing</em></a>, we
can propagate non-null values forward or backward:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1469]: </span><span class="n">df</span>

<span class="go">        one       two     three</span>
<span class="go">a       NaN  1.138469 -2.400634</span>
<span class="go">c       NaN  0.025653 -1.386071</span>
<span class="go">e  0.863937  0.252462  1.500571</span>
<span class="go">f  1.053202 -2.338595 -0.374279</span>
<span class="go">h       NaN -1.157886 -0.551865</span>

<span class="gp">In [1470]: </span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;pad&#39;</span><span class="p">)</span>

<span class="go">        one       two     three</span>
<span class="go">a       NaN  1.138469 -2.400634</span>
<span class="go">c       NaN  0.025653 -1.386071</span>
<span class="go">e  0.863937  0.252462  1.500571</span>
<span class="go">f  1.053202 -2.338595 -0.374279</span>
<span class="go">h  1.053202 -1.157886 -0.551865</span>
</pre></div>
</div>
<p id="missing-data-fillna-limit"><strong>Limit the amount of filling</strong></p>
<p>If we only want consecutive gaps filled up to a certain number of data points,
we can use the <cite>limit</cite> keyword:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1471]: </span><span class="n">df</span>

<span class="go">   one       two     three</span>
<span class="go">a  NaN  1.138469 -2.400634</span>
<span class="go">c  NaN  0.025653 -1.386071</span>
<span class="go">e  NaN       NaN       NaN</span>
<span class="go">f  NaN       NaN       NaN</span>
<span class="go">h  NaN -1.157886 -0.551865</span>

<span class="gp">In [1472]: </span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;pad&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="go">   one       two     three</span>
<span class="go">a  NaN  1.138469 -2.400634</span>
<span class="go">c  NaN  0.025653 -1.386071</span>
<span class="go">e  NaN  0.025653 -1.386071</span>
<span class="go">f  NaN       NaN       NaN</span>
<span class="go">h  NaN -1.157886 -0.551865</span>
</pre></div>
</div>
<p>To remind you, these are the available filling methods:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Action</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>pad / ffill</td>
<td>Fill values forward</td>
</tr>
<tr class="row-odd"><td>bfill / backfill</td>
<td>Fill values backward</td>
</tr>
</tbody>
</table>
<p>With time series data, using pad/ffill is extremely common so that the &#8220;last
known value&#8221; is available at every time point.</p>
</div>
<div class="section" id="dropping-axis-labels-with-missing-data-dropna">
<span id="missing-data-dropna"></span><h3>Dropping axis labels with missing data: dropna<a class="headerlink" href="#dropping-axis-labels-with-missing-data-dropna" title="Permalink to this headline">¶</a></h3>
<p>You may wish to simply exclude labels from a data set which refer to missing
data. To do this, use the <strong>dropna</strong> method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1473]: </span><span class="n">df</span>

<span class="go">   one       two     three</span>
<span class="go">a  NaN  1.138469 -2.400634</span>
<span class="go">c  NaN  0.025653 -1.386071</span>
<span class="go">e  NaN  0.000000  0.000000</span>
<span class="go">f  NaN  0.000000  0.000000</span>
<span class="go">h  NaN -1.157886 -0.551865</span>

<span class="gp">In [1474]: </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="go">Empty DataFrame</span>
<span class="go">Columns: [one, two, three]</span>
<span class="go">Index: []</span>

<span class="gp">In [1475]: </span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="go">        two     three</span>
<span class="go">a  1.138469 -2.400634</span>
<span class="go">c  0.025653 -1.386071</span>
<span class="go">e  0.000000  0.000000</span>
<span class="go">f  0.000000  0.000000</span>
<span class="go">h -1.157886 -0.551865</span>

<span class="gp">In [1476]: </span><span class="n">df</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="go">Series([], dtype: float64)</span>
</pre></div>
</div>
<p><strong>dropna</strong> is presently only implemented for Series and DataFrame, but will be
eventually added to Panel. Series.dropna is a simpler method as it only has one
axis to consider. DataFrame.dropna has considerably more options, which can be
examined <a class="reference internal" href="api.html#api-dataframe-missing"><em>in the API</em></a>.</p>
</div>
<div class="section" id="interpolation">
<span id="missing-data-interpolate"></span><h3>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline">¶</a></h3>
<p>A linear <strong>interpolate</strong> method has been implemented on Series. The default
interpolation assumes equally spaced points.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1477]: </span><span class="n">ts</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">61</span>

<span class="gp">In [1478]: </span><span class="n">ts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="go">2000-01-31    0.469112</span>
<span class="go">2000-02-29         NaN</span>
<span class="go">2000-03-31         NaN</span>
<span class="go">2000-04-28         NaN</span>
<span class="go">2000-05-31         NaN</span>
<span class="go">Freq: BM, dtype: float64</span>

<span class="gp">In [1479]: </span><span class="n">ts</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">100</span>

<span class="gp">In [1480]: </span><span class="n">ts</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="go">2000-01-31    0.469112</span>
<span class="go">2000-02-29    0.435428</span>
<span class="go">2000-03-31    0.401743</span>
<span class="go">2000-04-28    0.368059</span>
<span class="go">2000-05-31    0.334374</span>
<span class="go">Freq: BM, dtype: float64</span>

<span class="gp">In [1481]: </span><span class="n">ts</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;matplotlib.axes.AxesSubplot at 0x10aa97c50&gt;</span>
</pre></div>
</div>
<img alt="_images/series_interpolate.png" src="_images/series_interpolate.png" style="width: 6in;" />
<p>Index aware interpolation is available via the <tt class="docutils literal"><span class="pre">method</span></tt> keyword:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1482]: </span><span class="n">ts</span>

<span class="go">2000-01-31    0.469112</span>
<span class="go">2000-02-29         NaN</span>
<span class="go">2002-07-31   -5.689738</span>
<span class="go">2005-01-31         NaN</span>
<span class="go">2008-04-30   -8.916232</span>
<span class="go">dtype: float64</span>

<span class="gp">In [1483]: </span><span class="n">ts</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

<span class="go">2000-01-31    0.469112</span>
<span class="go">2000-02-29   -2.610313</span>
<span class="go">2002-07-31   -5.689738</span>
<span class="go">2005-01-31   -7.302985</span>
<span class="go">2008-04-30   -8.916232</span>
<span class="go">dtype: float64</span>

<span class="gp">In [1484]: </span><span class="n">ts</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">)</span>

<span class="go">2000-01-31    0.469112</span>
<span class="go">2000-02-29    0.273272</span>
<span class="go">2002-07-31   -5.689738</span>
<span class="go">2005-01-31   -7.095568</span>
<span class="go">2008-04-30   -8.916232</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>For a floating-point index, use <tt class="docutils literal"><span class="pre">method='values'</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1485]: </span><span class="n">ser</span>

<span class="go">0      0</span>
<span class="go">1    NaN</span>
<span class="go">10    10</span>
<span class="go">dtype: float64</span>

<span class="gp">In [1486]: </span><span class="n">ser</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>

<span class="go">0      0</span>
<span class="go">1      5</span>
<span class="go">10    10</span>
<span class="go">dtype: float64</span>

<span class="gp">In [1487]: </span><span class="n">ser</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;values&#39;</span><span class="p">)</span>

<span class="go">0      0</span>
<span class="go">1      1</span>
<span class="go">10    10</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="replacing-generic-values">
<span id="missing-data-replace"></span><h3>Replacing Generic Values<a class="headerlink" href="#replacing-generic-values" title="Permalink to this headline">¶</a></h3>
<p>Often times we want to replace arbitrary values with other values. New in v0.8
is the <tt class="docutils literal"><span class="pre">replace</span></tt> method in Series/DataFrame that provides an efficient yet
flexible way to perform such replacements.</p>
<p>For a Series, you can replace a single value or a list of values by another
value:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1488]: </span><span class="n">ser</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">])</span>

<span class="gp">In [1489]: </span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="go">0    5</span>
<span class="go">1    1</span>
<span class="go">2    2</span>
<span class="go">3    3</span>
<span class="go">4    4</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>You can replace a list of values by a list of other values:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1490]: </span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="go">0    4</span>
<span class="go">1    3</span>
<span class="go">2    2</span>
<span class="go">3    1</span>
<span class="go">4    0</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>You can also specify a mapping dict:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1491]: </span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>

<span class="go">0     10</span>
<span class="go">1    100</span>
<span class="go">2      2</span>
<span class="go">3      3</span>
<span class="go">4      4</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>For a DataFrame, you can specify individual values by column:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1492]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]})</span>

<span class="gp">In [1493]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="mi">100</span><span class="p">)</span>

<span class="go">     a    b</span>
<span class="go">0  100  100</span>
<span class="go">1    1    6</span>
<span class="go">2    2    7</span>
<span class="go">3    3    8</span>
<span class="go">4    4    9</span>
</pre></div>
</div>
<p>Instead of replacing with specified values, you can treat all given values as
missing and interpolate over them:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1494]: </span><span class="n">ser</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;pad&#39;</span><span class="p">)</span>

<span class="go">0    0</span>
<span class="go">1    0</span>
<span class="go">2    0</span>
<span class="go">3    0</span>
<span class="go">4    4</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</div>
<div class="section" id="string-regular-expression-replacement">
<span id="missing-data-replace-expression"></span><h3>String/Regular Expression Replacement<a class="headerlink" href="#string-regular-expression-replacement" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Python strings prefixed with the <tt class="docutils literal"><span class="pre">r</span></tt> character such as <tt class="docutils literal"><span class="pre">r'hello</span> <span class="pre">world'</span></tt>
are so-called &#8220;raw&#8221; strings. They have different semantics regarding
backslashes than strings without this prefix. Backslashes in raw strings
will be interpreted as an escaped backslash, e.g., <tt class="docutils literal"><span class="pre">r'\'</span> <span class="pre">==</span> <span class="pre">'\\'</span></tt>. You
should <a class="reference external" href="http://docs.python.org/2/reference/lexical_analysis.html#string-literals">read about them</a>
if this is unclear.</p>
</div>
<p>Replace the &#8216;.&#8217; with <tt class="docutils literal"><span class="pre">nan</span></tt> (str -&gt; str)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1495]: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s">&#39;ab..&#39;</span><span class="p">),</span> <span class="s">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">]}</span>

<span class="gp">In [1496]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="gp">In [1497]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="n">nan</span><span class="p">)</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    a    a</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  NaN  NaN</span>
<span class="go">3  3  NaN    d</span>
</pre></div>
</div>
<p>Now do it with a regular expression that removes surrounding whitespace
(regex -&gt; regex)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1498]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">r&#39;\s*\.\s*&#39;</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    a    a</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  NaN  NaN</span>
<span class="go">3  3  NaN    d</span>
</pre></div>
</div>
<p>Replace a few different values (list -&gt; list)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1499]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;.&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">nan</span><span class="p">])</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    b    b</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  NaN  NaN</span>
<span class="go">3  3  NaN    d</span>
</pre></div>
</div>
<p>list of regex -&gt; list of regex</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1500]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s">r&#39;\.&#39;</span><span class="p">,</span> <span class="s">r&#39;(a)&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;dot&#39;</span><span class="p">,</span> <span class="s">&#39;</span><span class="se">\1</span><span class="s">stuff&#39;</span><span class="p">],</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="go">   a       b       c</span>
<span class="go">0  0  stuff  stuff</span>
<span class="go">1  1       b       b</span>
<span class="go">2  2     dot     NaN</span>
<span class="go">3  3     dot       d</span>
</pre></div>
</div>
<p>Only search in column <tt class="docutils literal"><span class="pre">'b'</span></tt> (dict -&gt; dict)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1501]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="s">&#39;.&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">nan</span><span class="p">})</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    a    a</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  NaN  NaN</span>
<span class="go">3  3  NaN    d</span>
</pre></div>
</div>
<p>Same as the previous example, but use a regular expression for
searching instead (dict of regex -&gt; dict)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1502]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="s">r&#39;\s*\.\s*&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="n">nan</span><span class="p">},</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    a    a</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  NaN  NaN</span>
<span class="go">3  3  NaN    d</span>
</pre></div>
</div>
<p>You can pass nested dictionaries of regular expressions that use <tt class="docutils literal"><span class="pre">regex=True</span></tt></p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1503]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="s">r&#39;&#39;</span><span class="p">}},</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="go">   a  b    c</span>
<span class="go">0  0  a    a</span>
<span class="go">1  1       b</span>
<span class="go">2  2  .  NaN</span>
<span class="go">3  3  .    d</span>
</pre></div>
</div>
<p>or you can pass the nested dictionary like so</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1504]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">r&#39;\s*\.\s*&#39;</span><span class="p">:</span> <span class="n">nan</span><span class="p">}})</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    a    a</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  NaN  NaN</span>
<span class="go">3  3  NaN    d</span>
</pre></div>
</div>
<p>You can also use the group of a regular expression match when replacing (dict
of regex -&gt; dict of regex), this works for lists as well</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1505]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="s">r&#39;\s*(\.)\s*&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s">&#39;b&#39;</span><span class="p">:</span> <span class="s">r&#39;\1ty&#39;</span><span class="p">},</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="go">   a    b    c</span>
<span class="go">0  0    a    a</span>
<span class="go">1  1    b    b</span>
<span class="go">2  2  .ty  NaN</span>
<span class="go">3  3  .ty    d</span>
</pre></div>
</div>
<p>You can pass a list of regular expressions, of which those that match
will be replaced with a scalar (list of regex -&gt; regex)</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1506]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s">r&#39;\s*\.\s*&#39;</span><span class="p">,</span> <span class="s">r&#39;a|b&#39;</span><span class="p">],</span> <span class="n">nan</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="go">   a   b    c</span>
<span class="go">0  0 NaN  NaN</span>
<span class="go">1  1 NaN  NaN</span>
<span class="go">2  2 NaN  NaN</span>
<span class="go">3  3 NaN    d</span>
</pre></div>
</div>
<p>All of the regular expression examples can also be passed with the
<tt class="docutils literal"><span class="pre">to_replace</span></tt> argument as the <tt class="docutils literal"><span class="pre">regex</span></tt> argument. In this case the <tt class="docutils literal"><span class="pre">value</span></tt>
argument must be passed explicity by name or <tt class="docutils literal"><span class="pre">regex</span></tt> must be a nested
dictionary. The previous example, in this case, would then be</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1507]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">regex</span><span class="o">=</span><span class="p">[</span><span class="s">r&#39;\s*\.\s*&#39;</span><span class="p">,</span> <span class="s">r&#39;a|b&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="n">nan</span><span class="p">)</span>

<span class="go">   a   b    c</span>
<span class="go">0  0 NaN  NaN</span>
<span class="go">1  1 NaN  NaN</span>
<span class="go">2  2 NaN  NaN</span>
<span class="go">3  3 NaN    d</span>
</pre></div>
</div>
<p>This can be convenient if you do not want to pass <tt class="docutils literal"><span class="pre">regex=True</span></tt> every time you
want to use a regular expression.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Anywhere in the above <tt class="docutils literal"><span class="pre">replace</span></tt> examples that you see a regular expression
a compiled regular expression is valid as well.</p>
</div>
</div>
<div class="section" id="numeric-replacement">
<h3>Numeric Replacement<a class="headerlink" href="#numeric-replacement" title="Permalink to this headline">¶</a></h3>
<p>Similiar to <tt class="docutils literal"><span class="pre">DataFrame.fillna</span></tt></p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1508]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="gp">In [1509]: </span><span class="n">df</span><span class="p">[</span><span class="n">rand</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.5</span>

<span class="gp">In [1510]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">)</span>

<span class="go">          0         1</span>
<span class="go">0       NaN       NaN</span>
<span class="go">1       NaN       NaN</span>
<span class="go">2  2.396780  0.014871</span>
<span class="go">3       NaN       NaN</span>
<span class="go">4       NaN       NaN</span>
<span class="go">5       NaN       NaN</span>
<span class="go">6       NaN       NaN</span>
<span class="go">7  0.084844  0.432390</span>
<span class="go">8  1.519970 -0.493662</span>
<span class="go">9       NaN       NaN</span>
</pre></div>
</div>
<p>Replacing more than one value via lists works as well</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1511]: </span><span class="n">df00</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="gp">In [1512]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">df00</span><span class="p">],</span> <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">])</span>

<span class="go">            0           1</span>
<span class="go">0           a           a</span>
<span class="go">1           a           a</span>
<span class="go">2     2.39678  0.01487095</span>
<span class="go">3           a           a</span>
<span class="go">4           a           a</span>
<span class="go">5           a           a</span>
<span class="go">6           a           a</span>
<span class="go">7  0.08484421   0.4323898</span>
<span class="go">8     1.51997  -0.4936621</span>
<span class="go">9           a           a</span>

<span class="gp">In [1513]: </span><span class="n">df</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float64&#39;)</span>
</pre></div>
</div>
<p>You can also operate on the DataFrame in place</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1514]: </span><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="missing-data-casting-rules-and-indexing">
<h2>Missing data casting rules and indexing<a class="headerlink" href="#missing-data-casting-rules-and-indexing" title="Permalink to this headline">¶</a></h2>
<p>While pandas supports storing arrays of integer and boolean type, these types
are not capable of storing missing data. Until we can switch to using a native
NA type in NumPy, we&#8217;ve established some &#8220;casting rules&#8221; when reindexing will
cause missing data to be introduced into, say, a Series or DataFrame. Here they
are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">data type</th>
<th class="head">Cast to</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>integer</td>
<td>float</td>
</tr>
<tr class="row-odd"><td>boolean</td>
<td>object</td>
</tr>
<tr class="row-even"><td>float</td>
<td>no cast</td>
</tr>
<tr class="row-odd"><td>object</td>
<td>no cast</td>
</tr>
</tbody>
</table>
<p>For example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1515]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="gp">In [1516]: </span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="go">0    False</span>
<span class="go">2     True</span>
<span class="go">4     True</span>
<span class="go">6     True</span>
<span class="go">7    False</span>
<span class="go">dtype: bool</span>

<span class="gp">In [1517]: </span><span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;bool&#39;)</span>

<span class="gp">In [1518]: </span><span class="n">crit</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>

<span class="gp">In [1519]: </span><span class="n">crit</span>

<span class="go">0    False</span>
<span class="go">1      NaN</span>
<span class="go">2     True</span>
<span class="go">3      NaN</span>
<span class="go">4     True</span>
<span class="go">5      NaN</span>
<span class="go">6     True</span>
<span class="go">7    False</span>
<span class="go">dtype: object</span>

<span class="gp">In [1520]: </span><span class="n">crit</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;O&#39;)</span>
</pre></div>
</div>
<p>Ordinarily NumPy will complain if you try to use an object array (even if it
contains boolean values) instead of a boolean array to get or set values from
an ndarray (e.g. selecting values based on some criteria). If a boolean vector
contains NAs, an exception will be generated:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1521]: </span><span class="n">reindexed</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="gp">In [1522]: </span><span class="n">reindexed</span><span class="p">[</span><span class="n">crit</span><span class="p">]</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">ValueError                                Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-1522-2da204ed1ac7&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 reindexed[crit]</span>
<span class="go">/Users/Epsilon/Dropbox/Git/pandas/pandas/core/series.py in __getitem__(self, key)</span>
<span class="go">    636         # special handling of boolean data with NAs stored in object</span>
<span class="go">    637         # arrays. Since we can&#39;t represent NA with dtype=bool</span>
<span class="go">--&gt; 638         if _is_bool_indexer(key):</span>
<span class="go">    639             key = _check_bool_indexer(self.index, key)</span>
<span class="go">    640 </span>
<span class="go">/Users/Epsilon/Dropbox/Git/pandas/pandas/core/common.py in _is_bool_indexer(key)</span>
<span class="go">   1227         if not lib.is_bool_array(key):</span>
<span class="go">   1228             if isnull(key).any():</span>
<span class="go">-&gt; 1229                 raise ValueError(&#39;cannot index with vector containing &#39;</span>
<span class="go">   1230                                  &#39;NA / NaN values&#39;)</span>
<span class="go">   1231             return False</span>
<span class="go">ValueError: cannot index with vector containing NA / NaN values</span>
</pre></div>
</div>
<p>However, these can be filled in using <strong>fillna</strong> and it will work fine:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1523]: </span><span class="n">reindexed</span><span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">False</span><span class="p">)]</span>

<span class="go">2    1.063327</span>
<span class="go">4    1.266143</span>
<span class="go">6    0.299368</span>
<span class="go">dtype: float64</span>

<span class="gp">In [1524]: </span><span class="n">reindexed</span><span class="p">[</span><span class="n">crit</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="bp">True</span><span class="p">)]</span>

<span class="go">1    0.000000</span>
<span class="go">2    1.063327</span>
<span class="go">3    0.000000</span>
<span class="go">4    1.266143</span>
<span class="go">5    0.000000</span>
<span class="go">6    0.299368</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</div>
</div>


                    </div>
                </div>
            </div>

            
            <div class="clearer"></div>
        </div>
    </div>
</div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="groupby.html" title="Group By: split-apply-combine"
             >next</a> |</li>
        <li class="right" >
          <a href="computation.html" title="Computational tools"
             >previous</a> |</li>
        <li><a href="index.html">pandas 0.11.1.dev-36c1263 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2012, the pandas development team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>