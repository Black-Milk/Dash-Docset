

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>scipy.optimize.fmin_l_bfgs_b &mdash; SciPy v0.12 Reference Guide (DRAFT)</title>
    
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SciPy v0.12 Reference Guide (DRAFT)" href="../index.html" />
    <link rel="up" title="Optimization and root finding (scipy.optimize)" href="../optimize.html" />
    <link rel="next" title="scipy.optimize.fmin_tnc" href="scipy.optimize.fmin_tnc.html" />
    <link rel="prev" title="scipy.optimize.leastsq" href="scipy.optimize.leastsq.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.fmin_tnc.html" title="scipy.optimize.fmin_tnc"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.leastsq.html" title="scipy.optimize.leastsq"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> &raquo;</li>
          <li><a href="../optimize.html" accesskey="U">Optimization and root finding (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="scipy-optimize-fmin-l-bfgs-b">
<h1>scipy.optimize.fmin_l_bfgs_b<a class="headerlink" href="#scipy-optimize-fmin-l-bfgs-b" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.optimize.fmin_l_bfgs_b">
<tt class="descclassname">scipy.optimize.</tt><tt class="descname">fmin_l_bfgs_b</tt><big>(</big><em>func</em>, <em>x0</em>, <em>fprime=None</em>, <em>args=()</em>, <em>approx_grad=0</em>, <em>bounds=None</em>, <em>m=10</em>, <em>factr=10000000.0</em>, <em>pgtol=1e-05</em>, <em>epsilon=1e-08</em>, <em>iprint=-1</em>, <em>maxfun=15000</em>, <em>maxiter=15000</em>, <em>disp=None</em>, <em>callback=None</em><big>)</big><a class="reference external" href="http://github.com/scipy/scipy/blob/v0.12.0/scipy/optimize/lbfgsb.py#L46"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.optimize.fmin_l_bfgs_b" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize a function func using the L-BFGS-B algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>func</strong> : callable f(x,*args)</p>
<blockquote>
<div><p>Function to minimise.</p>
</div></blockquote>
<p><strong>x0</strong> : ndarray</p>
<blockquote>
<div><p>Initial guess.</p>
</div></blockquote>
<p><strong>fprime</strong> : callable fprime(x,*args)</p>
<blockquote>
<div><p>The gradient of <em class="xref py py-obj">func</em>.  If None, then <em class="xref py py-obj">func</em> returns the function
value and the gradient (<tt class="docutils literal"><span class="pre">f,</span> <span class="pre">g</span> <span class="pre">=</span> <span class="pre">func(x,</span> <span class="pre">*args)</span></tt>), unless
<em class="xref py py-obj">approx_grad</em> is True in which case <em class="xref py py-obj">func</em> returns only <tt class="docutils literal"><span class="pre">f</span></tt>.</p>
</div></blockquote>
<p><strong>args</strong> : sequence</p>
<blockquote>
<div><p>Arguments to pass to <em class="xref py py-obj">func</em> and <em class="xref py py-obj">fprime</em>.</p>
</div></blockquote>
<p><strong>approx_grad</strong> : bool</p>
<blockquote>
<div><p>Whether to approximate the gradient numerically (in which case
<em class="xref py py-obj">func</em> returns only the function value).</p>
</div></blockquote>
<p><strong>bounds</strong> : list</p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">(min,</span> <span class="pre">max)</span></tt> pairs for each element in <tt class="docutils literal"><span class="pre">x</span></tt>, defining
the bounds on that parameter. Use None for one of <tt class="docutils literal"><span class="pre">min</span></tt> or
<tt class="docutils literal"><span class="pre">max</span></tt> when there is no bound in that direction.</p>
</div></blockquote>
<p><strong>m</strong> : int</p>
<blockquote>
<div><p>The maximum number of variable metric corrections
used to define the limited memory matrix. (The limited memory BFGS
method does not store the full hessian but uses this many terms in an
approximation to it.)</p>
</div></blockquote>
<p><strong>factr</strong> : float</p>
<blockquote>
<div><p>The iteration stops when
<tt class="docutils literal"><span class="pre">(f^k</span> <span class="pre">-</span> <span class="pre">f^{k+1})/max{|f^k|,|f^{k+1}|,1}</span> <span class="pre">&lt;=</span> <span class="pre">factr</span> <span class="pre">*</span> <span class="pre">eps</span></tt>,
where <tt class="docutils literal"><span class="pre">eps</span></tt> is the machine precision, which is automatically
generated by the code. Typical values for <em class="xref py py-obj">factr</em> are: 1e12 for
low accuracy; 1e7 for moderate accuracy; 10.0 for extremely
high accuracy.</p>
</div></blockquote>
<p><strong>pgtol</strong> : float</p>
<blockquote>
<div><p>The iteration will stop when
<tt class="docutils literal"><span class="pre">max{|proj</span> <span class="pre">g_i</span> <span class="pre">|</span> <span class="pre">i</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">n}</span> <span class="pre">&lt;=</span> <span class="pre">pgtol</span></tt>
where <tt class="docutils literal"><span class="pre">pg_i</span></tt> is the i-th component of the projected gradient.</p>
</div></blockquote>
<p><strong>epsilon</strong> : float</p>
<blockquote>
<div><p>Step size used when <em class="xref py py-obj">approx_grad</em> is True, for numerically
calculating the gradient</p>
</div></blockquote>
<p><strong>iprint</strong> : int</p>
<blockquote>
<div><p>Controls the frequency of output. <tt class="docutils literal"><span class="pre">iprint</span> <span class="pre">&lt;</span> <span class="pre">0</span></tt> means no output;
<tt class="docutils literal"><span class="pre">iprint</span> <span class="pre">==</span> <span class="pre">0</span></tt> means write messages to stdout; <tt class="docutils literal"><span class="pre">iprint</span> <span class="pre">&gt;</span> <span class="pre">1</span></tt> in
addition means write logging information to a file named
<tt class="docutils literal"><span class="pre">iterate.dat</span></tt> in the current working directory.</p>
</div></blockquote>
<p><strong>disp</strong> : int, optional</p>
<blockquote>
<div><p>If zero, then no output.  If a positive number, then this over-rides
<em class="xref py py-obj">iprint</em> (i.e., <em class="xref py py-obj">iprint</em> gets the value of <em class="xref py py-obj">disp</em>).</p>
</div></blockquote>
<p><strong>maxfun</strong> : int</p>
<blockquote>
<div><p>Maximum number of function evaluations.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations.</p>
</div></blockquote>
<p><strong>callback</strong> : callable, optional</p>
<blockquote>
<div><p>Called after each iteration, as <tt class="docutils literal"><span class="pre">callback(xk)</span></tt>, where <tt class="docutils literal"><span class="pre">xk</span></tt> is the
current parameter vector.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>Estimated position of the minimum.</p>
</div></blockquote>
<p><strong>f</strong> : float</p>
<blockquote>
<div><p>Value of <em class="xref py py-obj">func</em> at the minimum.</p>
</div></blockquote>
<p><strong>d</strong> : dict</p>
<blockquote class="last">
<div><p>Information dictionary.</p>
<ul class="simple">
<li>d[&#8216;warnflag&#8217;] is<ul>
<li>0 if converged,</li>
<li>1 if too many function evaluations or too many iterations,</li>
<li>2 if stopped for another reason, given in d[&#8216;task&#8217;]</li>
</ul>
</li>
<li>d[&#8216;grad&#8217;] is the gradient at the minimum (should be 0 ish)</li>
<li>d[&#8216;funcalls&#8217;] is the number of function calls made.</li>
<li>d[&#8216;nit&#8217;] is the number of iterations.</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><tt class="xref py py-obj docutils literal"><span class="pre">minimize</span></tt></a></dt>
<dd>Interface to minimization algorithms for multivariate functions. See the &#8216;L-BFGS-B&#8217; <em class="xref py py-obj">method</em> in particular.</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>License of L-BFGS-B (FORTRAN code):</p>
<p>The version included here (in fortran code) is 3.0
(released April 25, 2011).  It was written by Ciyou Zhu, Richard Byrd,
and Jorge Nocedal &lt;<a class="reference external" href="mailto:nocedal&#37;&#52;&#48;ece&#46;nwu&#46;edu">nocedal<span>&#64;</span>ece<span>&#46;</span>nwu<span>&#46;</span>edu</a>&gt;. It carries the following
condition for use:</p>
<p>This software is freely available, but we expect that all publications
describing work using this software, or all commercial products using it,
quote at least one of the references given below. This software is released
under the BSD License.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>R. H. Byrd, P. Lu and J. Nocedal. A Limited Memory Algorithm for Bound
Constrained Optimization, (1995), SIAM Journal on Scientific and
Statistical Computing, 16, 5, pp. 1190-1208.</li>
<li>C. Zhu, R. H. Byrd and J. Nocedal. L-BFGS-B: Algorithm 778: L-BFGS-B,
FORTRAN routines for large scale bound constrained optimization (1997),
ACM Transactions on Mathematical Software, 23, 4, pp. 550 - 560.</li>
<li>J.L. Morales and J. Nocedal. L-BFGS-B: Remark on Algorithm 778: L-BFGS-B,
FORTRAN routines for large scale bound constrained optimization (2011),
ACM Transactions on Mathematical Software, 38, 1.</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.optimize.leastsq.html"
                        title="previous chapter">scipy.optimize.leastsq</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_tnc.html"
                        title="next chapter">scipy.optimize.fmin_tnc</a></p>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.fmin_tnc.html" title="scipy.optimize.fmin_tnc"
             >next</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.leastsq.html" title="scipy.optimize.leastsq"
             >previous</a> |</li>
        <li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> &raquo;</li>
          <li><a href="../optimize.html" >Optimization and root finding (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2009, The Scipy community.
      Last updated on May 01, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>