

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>scipy.spatial.Delaunay &mdash; SciPy v0.12 Reference Guide (DRAFT)</title>
    
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SciPy v0.12 Reference Guide (DRAFT)" href="../index.html" />
    <link rel="up" title="Spatial algorithms and data structures (scipy.spatial)" href="../spatial.html" />
    <link rel="next" title="scipy.spatial.Delaunay.transform" href="scipy.spatial.Delaunay.transform.html" />
    <link rel="prev" title="scipy.spatial.distance.yule" href="generated/scipy.spatial.distance.yule.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scipy.spatial.Delaunay.transform.html" title="scipy.spatial.Delaunay.transform"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="generated/scipy.spatial.distance.yule.html" title="scipy.spatial.distance.yule"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> &raquo;</li>
          <li><a href="../spatial.html" accesskey="U">Spatial algorithms and data structures (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.spatial</span></tt>)</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="scipy-spatial-delaunay">
<h1>scipy.spatial.Delaunay<a class="headerlink" href="#scipy-spatial-delaunay" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="scipy.spatial.Delaunay">
<em class="property">class </em><tt class="descclassname">scipy.spatial.</tt><tt class="descname">Delaunay</tt><big>(</big><em>points</em>, <em>furthest_site=False</em>, <em>incremental=False</em>, <em>qhull_options=None</em><big>)</big><a class="headerlink" href="#scipy.spatial.Delaunay" title="Permalink to this definition">¶</a></dt>
<dd><p>Delaunay tesselation in N dimensions.</p>
<p class="versionadded">
<span class="versionmodified">New in version 0.9.</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>points</strong> : ndarray of floats, shape (npoints, ndim)</p>
<blockquote>
<div><p>Coordinates of points to triangulate</p>
</div></blockquote>
<p><strong>furthest_site</strong> : bool, optional</p>
<blockquote>
<div><p>Whether to compute a furthest-site Delaunay triangulation.
Default: False</p>
<p class="versionadded">
<span class="versionmodified">New in version 0.12.0.</span></p>
</div></blockquote>
<p><strong>incremental</strong> : bool, optional</p>
<blockquote>
<div><p>Allow adding new points incrementally. This takes up some additional
resources.</p>
</div></blockquote>
<p><strong>qhull_options</strong> : str, optional</p>
<blockquote>
<div><p>Additional options to pass to Qhull. See Qhull manual for
details. Option &#8220;Qt&#8221; is always enabled.
Default:&#8221;Qbb Qc Qz Qx&#8221; for ndim &gt; 4 and &#8220;Qbb Qc Qz&#8221; otherwise.
Incremental mode omits &#8220;Qz&#8221;.</p>
<p class="versionadded">
<span class="versionmodified">New in version 0.12.0.</span></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises :</th><td class="field-body"><p class="first"><strong>QhullError</strong> :</p>
<blockquote class="last">
<div><p>Raised when Qhull encounters an error condition, such as
geometrical degeneracy when options to resolve are not enabled.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The tesselation is computed using the Qhull library <a class="reference internal" href="scipy.spatial.Voronoi.html#qhull">[Qhull]</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unless you pass in the Qhull option &#8220;QJ&#8221;, Qhull does not
guarantee that each input point appears as a vertex in the
Delaunay triangulation. Omitted points are listed in the
<em class="xref py py-obj">coplanar</em> attribute.</p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="qhull" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Qhull]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id3">3</a>, <a class="fn-backref" href="#id4">4</a>)</em> <a class="reference external" href="http://www.qhull.org/">http://www.qhull.org/</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Triangulation of a set of points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">Delaunay</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span> <span class="o">=</span> <span class="n">Delaunay</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
<p>We can plot it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">triplot</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../generated/scipy-spatial-Delaunay-1.py">Source code</a>)</p>
<div class="figure">
<img alt="../_images/scipy-spatial-Delaunay-1_00_00.png" src="../_images/scipy-spatial-Delaunay-1_00_00.png" />
</div>
<p>Point indices and coordinates for the two triangles forming the
triangulation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span><span class="o">.</span><span class="n">simplices</span>
<span class="go">array([[3, 2, 0],</span>
<span class="go">       [3, 1, 0]], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[</span><span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="p">]</span>
<span class="go">array([[[ 1. ,  1. ],</span>
<span class="go">        [ 1. ,  0. ],</span>
<span class="go">        [ 0. ,  0. ]],</span>
<span class="go">       [[ 1. ,  1. ],</span>
<span class="go">        [ 0. ,  1.1],</span>
<span class="go">        [ 0. ,  0. ]]])</span>
</pre></div>
</div>
<p>Triangle 0 is the only neighbor of triangle 1, and it&#8217;s opposite to
vertex 1 of triangle 1:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span><span class="o">.</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">array([-1,  0, -1], dtype=int32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[</span><span class="n">tri</span><span class="o">.</span><span class="n">simplices</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">array([ 0. ,  1.1])</span>
</pre></div>
</div>
<p>We can find out which triangle points are in:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tri</span><span class="o">.</span><span class="n">find_simplex</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">array([ 1, -1], dtype=int32)</span>
</pre></div>
</div>
<p>We can also compute barycentric coordinates in triangle 1 for
these points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="mi">1</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">tri</span><span class="o">.</span><span class="n">transform</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">array([[ 0.1       ,  0.2       ,  0.7       ],</span>
<span class="go">       [ 1.27272727,  0.27272727, -0.54545455]])</span>
</pre></div>
</div>
<p>The coordinates for the first point are all positive, meaning it
is indeed inside the triangle.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="scipy.spatial.Delaunay.transform.html#scipy.spatial.Delaunay.transform" title="scipy.spatial.Delaunay.transform"><tt class="xref py py-obj docutils literal"><span class="pre">transform</span></tt></a></td>
<td>Affine transform from <tt class="docutils literal"><span class="pre">x</span></tt> to the barycentric coordinates <tt class="docutils literal"><span class="pre">c</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="scipy.spatial.Delaunay.vertex_to_simplex.html#scipy.spatial.Delaunay.vertex_to_simplex" title="scipy.spatial.Delaunay.vertex_to_simplex"><tt class="xref py py-obj docutils literal"><span class="pre">vertex_to_simplex</span></tt></a></td>
<td>Lookup array, from a vertex, to some simplex which it is a part of.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="scipy.spatial.Delaunay.convex_hull.html#scipy.spatial.Delaunay.convex_hull" title="scipy.spatial.Delaunay.convex_hull"><tt class="xref py py-obj docutils literal"><span class="pre">convex_hull</span></tt></a></td>
<td>Vertices of facets forming the convex hull of the point set.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>points</td>
<td>(ndarray of double, shape (npoints, ndim)) Points in the triangulation.</td>
</tr>
<tr class="row-even"><td>simplices</td>
<td>(ndarray of ints, shape (nsimplex, ndim+1)) Indices of the points forming the simplices in the triangulation.</td>
</tr>
<tr class="row-odd"><td>neighbors</td>
<td>(ndarray of ints, shape (nsimplex, ndim+1)) Indices of neighbor simplices for each simplex. The kth neighbor is opposite to the kth vertex. For simplices at the boundary, -1 denotes no neighbor.</td>
</tr>
<tr class="row-even"><td>equations</td>
<td>(ndarray of double, shape (nsimplex, ndim+2)) [normal, offset] forming the hyperplane equation of the facet on the paraboloid (see <a class="reference internal" href="scipy.spatial.Voronoi.html#qhull">[Qhull]</a> documentation for more).</td>
</tr>
<tr class="row-odd"><td>paraboloid_scale, paraboloid_shift</td>
<td>(float) Scale and shift for the extra paraboloid dimension (see <a class="reference internal" href="scipy.spatial.Voronoi.html#qhull">[Qhull]</a> documentation for more).</td>
</tr>
<tr class="row-even"><td>coplanar</td>
<td>(ndarray of int, shape (ncoplanar, 3)) Indices of coplanar points and the corresponding indices of the nearest facet and the nearest vertex.  Coplanar points are input points which were <em>not</em> included in the triangulation due to numerical precision issues.  If option &#8220;Qc&#8221; is not specified, this list is not computed.  .. versionadded:: 0.12.0</td>
</tr>
<tr class="row-odd"><td>vertices</td>
<td>Same as <em class="xref py py-obj">simplices</em>, but deprecated.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="scipy.spatial.Delaunay.add_points.html#scipy.spatial.Delaunay.add_points" title="scipy.spatial.Delaunay.add_points"><tt class="xref py py-obj docutils literal"><span class="pre">add_points</span></tt></a>(points[,&nbsp;restart])</td>
<td>Process a set of additional new points.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="scipy.spatial.Delaunay.close.html#scipy.spatial.Delaunay.close" title="scipy.spatial.Delaunay.close"><tt class="xref py py-obj docutils literal"><span class="pre">close</span></tt></a>()</td>
<td>Finish incremental processing.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="scipy.spatial.Delaunay.find_simplex.html#scipy.spatial.Delaunay.find_simplex" title="scipy.spatial.Delaunay.find_simplex"><tt class="xref py py-obj docutils literal"><span class="pre">find_simplex</span></tt></a>(self,&nbsp;xi[,&nbsp;bruteforce,&nbsp;tol])</td>
<td>Find the simplices containing the given points.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="scipy.spatial.Delaunay.lift_points.html#scipy.spatial.Delaunay.lift_points" title="scipy.spatial.Delaunay.lift_points"><tt class="xref py py-obj docutils literal"><span class="pre">lift_points</span></tt></a>(self,&nbsp;x)</td>
<td>Lift points to the Qhull paraboloid.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="scipy.spatial.Delaunay.plane_distance.html#scipy.spatial.Delaunay.plane_distance" title="scipy.spatial.Delaunay.plane_distance"><tt class="xref py py-obj docutils literal"><span class="pre">plane_distance</span></tt></a>(self,&nbsp;xi)</td>
<td>Compute hyperplane distances to the point <em class="xref py py-obj">xi</em> from all simplices.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="generated/scipy.spatial.distance.yule.html"
                        title="previous chapter">scipy.spatial.distance.yule</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.spatial.Delaunay.transform.html"
                        title="next chapter">scipy.spatial.Delaunay.transform</a></p>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scipy.spatial.Delaunay.transform.html" title="scipy.spatial.Delaunay.transform"
             >next</a> |</li>
        <li class="right" >
          <a href="generated/scipy.spatial.distance.yule.html" title="scipy.spatial.distance.yule"
             >previous</a> |</li>
        <li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> &raquo;</li>
          <li><a href="../spatial.html" >Spatial algorithms and data structures (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.spatial</span></tt>)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2009, The Scipy community.
      Last updated on May 01, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>