

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>scipy.optimize.leastsq &mdash; SciPy v0.12 Reference Guide (DRAFT)</title>
    
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="SciPy v0.12 Reference Guide (DRAFT)" href="../index.html" />
    <link rel="up" title="Optimization and root finding (scipy.optimize)" href="../optimize.html" />
    <link rel="next" title="scipy.optimize.fmin_l_bfgs_b" href="scipy.optimize.fmin_l_bfgs_b.html" />
    <link rel="prev" title="scipy.optimize.fmin_ncg" href="scipy.optimize.fmin_ncg.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.fmin_l_bfgs_b.html" title="scipy.optimize.fmin_l_bfgs_b"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.fmin_ncg.html" title="scipy.optimize.fmin_ncg"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> &raquo;</li>
          <li><a href="../optimize.html" accesskey="U">Optimization and root finding (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="scipy-optimize-leastsq">
<h1>scipy.optimize.leastsq<a class="headerlink" href="#scipy-optimize-leastsq" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.optimize.leastsq">
<tt class="descclassname">scipy.optimize.</tt><tt class="descname">leastsq</tt><big>(</big><em>func</em>, <em>x0</em>, <em>args=()</em>, <em>Dfun=None</em>, <em>full_output=0</em>, <em>col_deriv=0</em>, <em>ftol=1.49012e-08</em>, <em>xtol=1.49012e-08</em>, <em>gtol=0.0</em>, <em>maxfev=0</em>, <em>epsfcn=None</em>, <em>factor=100</em>, <em>diag=None</em><big>)</big><a class="reference external" href="http://github.com/scipy/scipy/blob/v0.12.0/scipy/optimize/minpack.py#L246"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.optimize.leastsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize the sum of squares of a set of equations.</p>
<div class="highlight-python"><pre>x = arg min(sum(func(y)**2,axis=0))
         y</pre>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>func</strong> : callable</p>
<blockquote>
<div><p>should take at least one (possibly length N vector) argument and
returns M floating point numbers.</p>
</div></blockquote>
<p><strong>x0</strong> : ndarray</p>
<blockquote>
<div><p>The starting estimate for the minimization.</p>
</div></blockquote>
<p><strong>args</strong> : tuple</p>
<blockquote>
<div><p>Any extra arguments to func are placed in this tuple.</p>
</div></blockquote>
<p><strong>Dfun</strong> : callable</p>
<blockquote>
<div><p>A function or method to compute the Jacobian of func with derivatives
across the rows. If this is None, the Jacobian will be estimated.</p>
</div></blockquote>
<p><strong>full_output</strong> : bool</p>
<blockquote>
<div><p>non-zero to return all optional outputs.</p>
</div></blockquote>
<p><strong>col_deriv</strong> : bool</p>
<blockquote>
<div><p>non-zero to specify that the Jacobian function computes derivatives
down the columns (faster, because there is no transpose operation).</p>
</div></blockquote>
<p><strong>ftol</strong> : float</p>
<blockquote>
<div><p>Relative error desired in the sum of squares.</p>
</div></blockquote>
<p><strong>xtol</strong> : float</p>
<blockquote>
<div><p>Relative error desired in the approximate solution.</p>
</div></blockquote>
<p><strong>gtol</strong> : float</p>
<blockquote>
<div><p>Orthogonality desired between the function vector and the columns of
the Jacobian.</p>
</div></blockquote>
<p><strong>maxfev</strong> : int</p>
<blockquote>
<div><p>The maximum number of calls to the function. If zero, then 100*(N+1) is
the maximum where N is the number of elements in x0.</p>
</div></blockquote>
<p><strong>epsfcn</strong> : float</p>
<blockquote>
<div><p>A suitable step length for the forward-difference approximation of the
Jacobian (for Dfun=None). If epsfcn is less than the machine precision,
it is assumed that the relative errors in the functions are of the
order of the machine precision.</p>
</div></blockquote>
<p><strong>factor</strong> : float</p>
<blockquote>
<div><p>A parameter determining the initial step bound
(<tt class="docutils literal"><span class="pre">factor</span> <span class="pre">*</span> <span class="pre">||</span> <span class="pre">diag</span> <span class="pre">*</span> <span class="pre">x||</span></tt>). Should be in interval <tt class="docutils literal"><span class="pre">(0.1,</span> <span class="pre">100)</span></tt>.</p>
</div></blockquote>
<p><strong>diag</strong> : sequence</p>
<blockquote>
<div><p>N positive entries that serve as a scale factors for the variables.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>x</strong> : ndarray</p>
<blockquote>
<div><p>The solution (or the result of the last iteration for an unsuccessful
call).</p>
</div></blockquote>
<p><strong>cov_x</strong> : ndarray</p>
<blockquote>
<div><p>Uses the fjac and ipvt optional outputs to construct an
estimate of the jacobian around the solution.  <tt class="docutils literal"><span class="pre">None</span></tt> if a
singular matrix encountered (indicates very flat curvature in
some direction).  This matrix must be multiplied by the
residual variance to get the covariance of the
parameter estimates &#8211; see curve_fit.</p>
</div></blockquote>
<p><strong>infodict</strong> : dict</p>
<blockquote>
<div><p>a dictionary of optional outputs with the key s:</p>
<div class="highlight-python"><pre>- 'nfev' : the number of function calls
- 'fvec' : the function evaluated at the output
- 'fjac' : A permutation of the R matrix of a QR
         factorization of the final approximate
         Jacobian matrix, stored column wise.
         Together with ipvt, the covariance of the
         estimate can be approximated.
- 'ipvt' : an integer array of length N which defines
         a permutation matrix, p, such that
         fjac*p = q*r, where r is upper triangular
         with diagonal elements of nonincreasing
         magnitude. Column j of p is column ipvt(j)
         of the identity matrix.
- 'qtf'  : the vector (transpose(q) * fvec).</pre>
</div>
</div></blockquote>
<p><strong>mesg</strong> : str</p>
<blockquote>
<div><p>A string message giving information about the cause of failure.</p>
</div></blockquote>
<p><strong>ier</strong> : int</p>
<blockquote class="last">
<div><p>An integer flag.  If it is equal to 1, 2, 3 or 4, the solution was
found.  Otherwise, the solution was not found. In either case, the
optional output variable &#8216;mesg&#8217; gives more information.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>&#8220;leastsq&#8221; is a wrapper around MINPACK&#8217;s lmdif and lmder algorithms.</p>
<p>cov_x is a Jacobian approximation to the Hessian of the least squares
objective function.
This approximation assumes that the objective function is based on the
difference between some observed target data (ydata) and a (non-linear)
function of the parameters <em class="xref py py-obj">f(xdata, params)</em></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">func</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="o">=</span> <span class="n">ydata</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<p>so that the objective function is</p>
<div class="highlight-python"><pre>  min   sum((ydata - f(xdata, params))**2, axis=0)
params</pre>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/scipyshiny_small.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_ncg.html"
                        title="previous chapter">scipy.optimize.fmin_ncg</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.optimize.fmin_l_bfgs_b.html"
                        title="next chapter">scipy.optimize.fmin_l_bfgs_b</a></p>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.fmin_l_bfgs_b.html" title="scipy.optimize.fmin_l_bfgs_b"
             >next</a> |</li>
        <li class="right" >
          <a href="scipy.optimize.fmin_ncg.html" title="scipy.optimize.fmin_ncg"
             >previous</a> |</li>
        <li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> &raquo;</li>
          <li><a href="../optimize.html" >Optimization and root finding (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2009, The Scipy community.
      Last updated on May 01, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>