

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Merge, join, and concatenate &mdash; pandas 0.13.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.13.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pandas 0.13.1 documentation" href="index.html" />
    <link rel="next" title="Reshaping and Pivot Tables" href="reshaping.html" />
    <link rel="prev" title="Group By: split-apply-combine" href="groupby.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reshaping.html" title="Reshaping and Pivot Tables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="groupby.html" title="Group By: split-apply-combine"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">pandas 0.13.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
<div class="content-wrapper">
    <div class="content">
        <div class="document">
            <div class="sphinxsidebar">
                <h3>Table Of Contents</h3>
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">What&#8217;s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Package overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="10min.html">10 Minutes to Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="dsintro.html">Intro to Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Essential Basic Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="indexing.html">Indexing and Selecting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="computation.html">Computational tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="missing_data.html">Working with missing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="groupby.html">Group By: split-apply-combine</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Merge, join, and concatenate</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#concatenating-objects">Concatenating objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#set-logic-on-the-other-axes">Set logic on the other axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#concatenating-using-append">Concatenating using <tt class="docutils literal"><span class="pre">append</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ignoring-indexes-on-the-concatenation-axis">Ignoring indexes on the concatenation axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-concatenating-with-group-keys">More concatenating with group keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="#appending-rows-to-a-dataframe">Appending rows to a DataFrame</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#database-style-dataframe-joining-merging">Database-style DataFrame joining/merging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#brief-primer-on-merge-methods-relational-algebra">Brief primer on merge methods (relational algebra)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#joining-on-index">Joining on index</a></li>
<li class="toctree-l3"><a class="reference internal" href="#joining-key-columns-on-an-index">Joining key columns on an index</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overlapping-value-columns">Overlapping value columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#merging-ordered-data">Merging Ordered Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#joining-multiple-dataframe-or-panel-objects">Joining multiple DataFrame or Panel objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="#merging-together-values-within-series-or-dataframe-columns">Merging together values within Series or DataFrame columns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reshaping.html">Reshaping and Pivot Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="timeseries.html">Time Series / Date functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Plotting with matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="rplot.html">Trellis plotting interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO Tools (Text, CSV, HDF5, ...)</a></li>
<li class="toctree-l1"><a class="reference internal" href="remote_data.html">Remote Data Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="enhancingperf.html">Enhancing Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="sparse.html">Sparse data structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="gotchas.html">Caveats and Gotchas</a></li>
<li class="toctree-l1"><a class="reference internal" href="r_interface.html">rpy2 / R interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="ecosystem.html">Pandas Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_r.html">Comparison with R / R libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_with_sql.html">Comparison with SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Notes</a></li>
</ul>

                <h3 style="margin-top: 1.5em;">Search</h3>

                <form class="search" action="search.html" method="get">
                    <input type="text" name="q" size="18"/>
                    <input type="submit" value="Go"/>
                    <input type="hidden" name="check_keywords" value="yes"/>
                    <input type="hidden" name="area" value="default"/>
                </form>
                <p class="searchtip" style="font-size: 90%">
                    Enter search terms or a module, class or function name.
                </p>

                <p>

                <p>
                    <script type="text/javascript"
                            src="http://www.ohloh.net/p/482908/widgets/project_partner_badge.js"></script>
                </p>
            </div>
             
            <div class="documentwrapper">
                <div class="bodywrapper">
                    <div class="body">
                        
  <div class="section" id="merge-join-and-concatenate">
<span id="merging"></span><h1>Merge, join, and concatenate<a class="headerlink" href="#merge-join-and-concatenate" title="Permalink to this headline">¶</a></h1>
<p>pandas provides various facilities for easily combining together Series,
DataFrame, and Panel objects with various kinds of set logic for the indexes
and relational algebra functionality in the case of join / merge-type
operations.</p>
<div class="section" id="concatenating-objects">
<span id="merging-concat"></span><h2>Concatenating objects<a class="headerlink" href="#concatenating-objects" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">concat</span></tt> function (in the main pandas namespace) does all of the heavy
lifting of performing concatenation operations along an axis while performing
optional set logic (union or intersection) of the indexes (if any) on the other
axes. Note that I say &#8220;if any&#8221; because there is only a single possible axis of
concatenation for Series.</p>
<p>Before diving into all of the details of <tt class="docutils literal"><span class="pre">concat</span></tt> and what it can do, here is
a simple example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="gp">In [2]: </span><span class="n">df</span>
<span class="gr">Out[2]: </span>
<span class="go">          0         1         2         3</span>
<span class="go">0  0.469112 -0.282863 -1.509059 -1.135632</span>
<span class="go">1  1.212112 -0.173215  0.119209 -1.044236</span>
<span class="go">2 -0.861849 -2.104569 -0.494929  1.071804</span>
<span class="go">3  0.721555 -0.706771 -1.039575  0.271860</span>
<span class="go">4 -0.424972  0.567020  0.276232 -1.087401</span>
<span class="go">5 -0.673690  0.113648 -1.478427  0.524988</span>
<span class="go">6  0.404705  0.577046 -1.715002 -1.039268</span>
<span class="go">7 -0.370647 -1.157892 -1.344312  0.844885</span>
<span class="go">8  1.075770 -0.109050  1.643563 -1.469388</span>
<span class="go">9  0.357021 -0.674600 -1.776904 -0.968914</span>

<span class="go">[10 rows x 4 columns]</span>

<span class="c"># break it into pieces</span>
<span class="gp">In [3]: </span><span class="n">pieces</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="mi">7</span><span class="p">:]]</span>

<span class="gp">In [4]: </span><span class="n">concatenated</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">concatenated</span>
<span class="gr">Out[5]: </span>
<span class="go">          0         1         2         3</span>
<span class="go">0  0.469112 -0.282863 -1.509059 -1.135632</span>
<span class="go">1  1.212112 -0.173215  0.119209 -1.044236</span>
<span class="go">2 -0.861849 -2.104569 -0.494929  1.071804</span>
<span class="go">3  0.721555 -0.706771 -1.039575  0.271860</span>
<span class="go">4 -0.424972  0.567020  0.276232 -1.087401</span>
<span class="go">5 -0.673690  0.113648 -1.478427  0.524988</span>
<span class="go">6  0.404705  0.577046 -1.715002 -1.039268</span>
<span class="go">7 -0.370647 -1.157892 -1.344312  0.844885</span>
<span class="go">8  1.075770 -0.109050  1.643563 -1.469388</span>
<span class="go">9  0.357021 -0.674600 -1.776904 -0.968914</span>

<span class="go">[10 rows x 4 columns]</span>
</pre></div>
</div>
<p>Like its sibling function on ndarrays, <tt class="docutils literal"><span class="pre">numpy.concatenate</span></tt>, <tt class="docutils literal"><span class="pre">pandas.concat</span></tt>
takes a list or dict of homogeneously-typed objects and concatenates them with
some configurable handling of &#8220;what to do with the other axes&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s">&#39;outer&#39;</span><span class="p">,</span> <span class="n">join_axes</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
       <span class="n">keys</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">objs</span></tt>: list or dict of Series, DataFrame, or Panel objects. If a dict is
passed, the sorted keys will be used as the <cite>keys</cite> argument, unless it is
passed, in which case the values will be selected (see below)</li>
<li><tt class="docutils literal"><span class="pre">axis</span></tt>: {0, 1, ...}, default 0. The axis to concatenate along</li>
<li><tt class="docutils literal"><span class="pre">join</span></tt>: {&#8216;inner&#8217;, &#8216;outer&#8217;}, default &#8216;outer&#8217;. How to handle indexes on
other axis(es). Outer for union and inner for intersection</li>
<li><tt class="docutils literal"><span class="pre">join_axes</span></tt>: list of Index objects. Specific indexes to use for the other
n - 1 axes instead of performing inner/outer set logic</li>
<li><tt class="docutils literal"><span class="pre">keys</span></tt>: sequence, default None. Construct hierarchical index using the
passed keys as the outermost level If multiple levels passed, should
contain tuples.</li>
<li><tt class="docutils literal"><span class="pre">levels</span></tt> : list of sequences, default None. If keys passed, specific
levels to use for the resulting MultiIndex. Otherwise they will be inferred
from the keys</li>
<li><tt class="docutils literal"><span class="pre">names</span></tt>: list, default None. Names for the levels in the resulting
hierarchical index</li>
<li><tt class="docutils literal"><span class="pre">verify_integrity</span></tt>: boolean, default False. Check whether the new
concatenated axis contains duplicates. This can be very expensive relative
to the actual data concatenation</li>
<li><tt class="docutils literal"><span class="pre">ignore_index</span></tt> : boolean, default False. If True, do not use the index
values on the concatenation axis. The resulting axis will be labeled 0, ...,
n - 1. This is useful if you are concatenating objects where the
concatenation axis does not have meaningful indexing information.</li>
</ul>
<p>Without a little bit of context and example many of these arguments don&#8217;t make
much sense. Let&#8217;s take the above example. Suppose we wanted to associate
specific keys with each of the pieces of the chopped up DataFrame. We can do
this using the <tt class="docutils literal"><span class="pre">keys</span></tt> argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="n">concatenated</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;first&#39;</span><span class="p">,</span> <span class="s">&#39;second&#39;</span><span class="p">,</span> <span class="s">&#39;third&#39;</span><span class="p">])</span>

<span class="gp">In [7]: </span><span class="n">concatenated</span>
<span class="gr">Out[7]: </span>
<span class="go">                 0         1         2         3</span>
<span class="go">first  0  0.469112 -0.282863 -1.509059 -1.135632</span>
<span class="go">       1  1.212112 -0.173215  0.119209 -1.044236</span>
<span class="go">       2 -0.861849 -2.104569 -0.494929  1.071804</span>
<span class="go">second 3  0.721555 -0.706771 -1.039575  0.271860</span>
<span class="go">       4 -0.424972  0.567020  0.276232 -1.087401</span>
<span class="go">       5 -0.673690  0.113648 -1.478427  0.524988</span>
<span class="go">       6  0.404705  0.577046 -1.715002 -1.039268</span>
<span class="go">third  7 -0.370647 -1.157892 -1.344312  0.844885</span>
<span class="go">       8  1.075770 -0.109050  1.643563 -1.469388</span>
<span class="go">       9  0.357021 -0.674600 -1.776904 -0.968914</span>

<span class="go">[10 rows x 4 columns]</span>
</pre></div>
</div>
<p>As you can see (if you&#8217;ve read the rest of the documentation), the resulting
object&#8217;s index has a <a class="reference internal" href="indexing.html#indexing-hierarchical"><em>hierarchical index</em></a>. This
means that we can now do stuff like select out each chunk by key:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [8]: </span><span class="n">concatenated</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="s">&#39;second&#39;</span><span class="p">]</span>
<span class="gr">Out[8]: </span>
<span class="go">          0         1         2         3</span>
<span class="go">3  0.721555 -0.706771 -1.039575  0.271860</span>
<span class="go">4 -0.424972  0.567020  0.276232 -1.087401</span>
<span class="go">5 -0.673690  0.113648 -1.478427  0.524988</span>
<span class="go">6  0.404705  0.577046 -1.715002 -1.039268</span>

<span class="go">[4 rows x 4 columns]</span>
</pre></div>
</div>
<p>It&#8217;s not a stretch to see how this can be very useful. More detail on this
functionality below.</p>
<div class="section" id="set-logic-on-the-other-axes">
<h3>Set logic on the other axes<a class="headerlink" href="#set-logic-on-the-other-axes" title="Permalink to this headline">¶</a></h3>
<p>When gluing together multiple DataFrames (or Panels or...), for example, you
have a choice of how to handle the other axes (other than the one being
concatenated). This can be done in three ways:</p>
<ul class="simple">
<li>Take the (sorted) union of them all, <tt class="docutils literal"><span class="pre">join='outer'</span></tt>. This is the default
option as it results in zero information loss.</li>
<li>Take the intersection, <tt class="docutils literal"><span class="pre">join='inner'</span></tt>.</li>
<li>Use a specific index (in the case of DataFrame) or indexes (in the case of
Panel or future higher dimensional objects), i.e. the <tt class="docutils literal"><span class="pre">join_axes</span></tt> argument</li>
</ul>
<p>Here is a example of each of these methods. First, the default <tt class="docutils literal"><span class="pre">join='outer'</span></tt>
behavior:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [9]: </span><span class="kn">from</span> <span class="nn">pandas.util.testing</span> <span class="kn">import</span> <span class="n">rands</span>

<span class="gp">In [10]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="s">&#39;c&#39;</span><span class="p">,</span> <span class="s">&#39;d&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">rands</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [11]: </span><span class="n">df</span>
<span class="gr">Out[11]: </span>
<span class="go">              a         b         c         d</span>
<span class="go">6I74i -1.294524  0.413738  0.276662 -0.472035</span>
<span class="go">RP8O8 -0.013960 -0.362543 -0.006154 -0.923061</span>
<span class="go">lTKuy  0.895717  0.805244 -1.206412  2.565646</span>
<span class="go">BmVOx  1.431256  1.340309 -1.170299 -0.226169</span>
<span class="go">qp7p7  0.410835  0.813850  0.132003 -0.827317</span>
<span class="go">k3K2f -0.076467 -1.187678  1.130127 -1.436737</span>
<span class="go">HGqMS -1.413681  1.607920  1.024180  0.569605</span>
<span class="go">Xby44  0.875906 -2.211372  0.974466 -2.006747</span>
<span class="go">PL69Z -0.410001 -0.078638  0.545952 -1.219217</span>
<span class="go">AZAf4 -1.226825  0.769804 -1.281247 -0.727707</span>

<span class="go">[10 rows x 4 columns]</span>

<span class="gp">In [12]: </span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]],</span>
<span class="gp">   ....:</span>         <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:,</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">   ....:</span> 
<span class="gr">Out[12]: </span>
<span class="go">              a         b         c         d</span>
<span class="go">6I74i -1.294524  0.413738       NaN       NaN</span>
<span class="go">AZAf4       NaN       NaN       NaN -0.727707</span>
<span class="go">BmVOx  1.431256  1.340309 -1.170299 -0.226169</span>
<span class="go">HGqMS -1.413681  1.607920  1.024180  0.569605</span>
<span class="go">PL69Z       NaN       NaN       NaN -1.219217</span>
<span class="go">RP8O8 -0.013960 -0.362543       NaN       NaN</span>
<span class="go">Xby44       NaN       NaN  0.974466 -2.006747</span>
<span class="go">k3K2f -0.076467 -1.187678  1.130127 -1.436737</span>
<span class="go">lTKuy  0.895717  0.805244 -1.206412       NaN</span>
<span class="go">qp7p7  0.410835  0.813850  0.132003 -0.827317</span>

<span class="go">[10 rows x 4 columns]</span>
</pre></div>
</div>
<p>Note that the row indexes have been unioned and sorted. Here is the same thing
with <tt class="docutils literal"><span class="pre">join='inner'</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [13]: </span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]],</span>
<span class="gp">   ....:</span>         <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:,</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s">&#39;inner&#39;</span><span class="p">)</span>
<span class="gp">   ....:</span> 
<span class="gr">Out[13]: </span>
<span class="go">              a         b         c         d</span>
<span class="go">BmVOx  1.431256  1.340309 -1.170299 -0.226169</span>
<span class="go">qp7p7  0.410835  0.813850  0.132003 -0.827317</span>
<span class="go">k3K2f -0.076467 -1.187678  1.130127 -1.436737</span>
<span class="go">HGqMS -1.413681  1.607920  1.024180  0.569605</span>

<span class="go">[4 rows x 4 columns]</span>
</pre></div>
</div>
<p>Lastly, suppose we just wanted to reuse the <em>exact index</em> from the original
DataFrame:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [14]: </span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="mi">7</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;b&#39;</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;c&#39;</span><span class="p">]],</span>
<span class="gp">   ....:</span>         <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">:,</span> <span class="p">[</span><span class="s">&#39;d&#39;</span><span class="p">]]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">join_axes</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
<span class="gp">   ....:</span> 
<span class="gr">Out[14]: </span>
<span class="go">              a         b         c         d</span>
<span class="go">6I74i -1.294524  0.413738       NaN       NaN</span>
<span class="go">RP8O8 -0.013960 -0.362543       NaN       NaN</span>
<span class="go">lTKuy  0.895717  0.805244 -1.206412       NaN</span>
<span class="go">BmVOx  1.431256  1.340309 -1.170299 -0.226169</span>
<span class="go">qp7p7  0.410835  0.813850  0.132003 -0.827317</span>
<span class="go">k3K2f -0.076467 -1.187678  1.130127 -1.436737</span>
<span class="go">HGqMS -1.413681  1.607920  1.024180  0.569605</span>
<span class="go">Xby44       NaN       NaN  0.974466 -2.006747</span>
<span class="go">PL69Z       NaN       NaN       NaN -1.219217</span>
<span class="go">AZAf4       NaN       NaN       NaN -0.727707</span>

<span class="go">[10 rows x 4 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="concatenating-using-append">
<span id="merging-concatenation"></span><h3>Concatenating using <tt class="docutils literal"><span class="pre">append</span></tt><a class="headerlink" href="#concatenating-using-append" title="Permalink to this headline">¶</a></h3>
<p>A useful shortcut to <tt class="docutils literal"><span class="pre">concat</span></tt> are the <tt class="docutils literal"><span class="pre">append</span></tt> instance methods on Series
and DataFrame. These methods actually predated <tt class="docutils literal"><span class="pre">concat</span></tt>. They concatenate
along <tt class="docutils literal"><span class="pre">axis=0</span></tt>, namely the index:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

<span class="gp">In [16]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">s</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="c"># note we&#39;re slicing with labels here, so 5 is included</span>

<span class="gp">In [17]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>

<span class="gp">In [18]: </span><span class="n">s1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="gr">Out[18]: </span>
<span class="go">0   -0.121306</span>
<span class="go">1   -0.097883</span>
<span class="go">2    0.695775</span>
<span class="go">3    0.341734</span>
<span class="go">4    0.959726</span>
<span class="go">6   -0.619976</span>
<span class="go">7    0.149748</span>
<span class="go">8   -0.732339</span>
<span class="go">9    0.687738</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p>In the case of DataFrame, the indexes must be disjoint but the columns do not
need to be:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [19]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">date_range</span><span class="p">(</span><span class="s">&#39;1/1/2000&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
<span class="gp">   ....:</span>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [20]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [21]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">3</span><span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>

<span class="gp">In [22]: </span><span class="n">df1</span>
<span class="gr">Out[22]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-01  0.176444  0.403310 -0.154951  0.301624</span>
<span class="go">2000-01-02 -2.179861 -1.369849 -0.954208  1.462696</span>
<span class="go">2000-01-03 -1.743161 -0.826591 -0.345352  1.314232</span>

<span class="go">[3 rows x 4 columns]</span>

<span class="gp">In [23]: </span><span class="n">df2</span>
<span class="gr">Out[23]: </span>
<span class="go">                   A         B         C</span>
<span class="go">2000-01-04  0.690579  0.995761  2.396780</span>
<span class="go">2000-01-05  3.357427 -0.317441 -1.236269</span>
<span class="go">2000-01-06 -0.487602 -0.082240 -2.182937</span>

<span class="go">[3 rows x 3 columns]</span>

<span class="gp">In [24]: </span><span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[24]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-01  0.176444  0.403310 -0.154951  0.301624</span>
<span class="go">2000-01-02 -2.179861 -1.369849 -0.954208  1.462696</span>
<span class="go">2000-01-03 -1.743161 -0.826591 -0.345352  1.314232</span>
<span class="go">2000-01-04  0.690579  0.995761  2.396780       NaN</span>
<span class="go">2000-01-05  3.357427 -0.317441 -1.236269       NaN</span>
<span class="go">2000-01-06 -0.487602 -0.082240 -2.182937       NaN</span>

<span class="go">[6 rows x 4 columns]</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">append</span></tt> may take multiple objects to concatenate:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [25]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [26]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>

<span class="gp">In [27]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>

<span class="gp">In [28]: </span><span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span><span class="n">df3</span><span class="p">])</span>
<span class="gr">Out[28]: </span>
<span class="go">                   A         B         C         D</span>
<span class="go">2000-01-01  0.176444  0.403310 -0.154951  0.301624</span>
<span class="go">2000-01-02 -2.179861 -1.369849 -0.954208  1.462696</span>
<span class="go">2000-01-03 -1.743161 -0.826591 -0.345352  1.314232</span>
<span class="go">2000-01-04  0.690579  0.995761  2.396780  0.014871</span>
<span class="go">2000-01-05  3.357427 -0.317441 -1.236269  0.896171</span>
<span class="go">2000-01-06 -0.487602 -0.082240 -2.182937  0.380396</span>

<span class="go">[6 rows x 4 columns]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Unlike <cite>list.append</cite> method, which appends to the original list and
returns nothing, <tt class="docutils literal"><span class="pre">append</span></tt> here <strong>does not</strong> modify <tt class="docutils literal"><span class="pre">df1</span></tt> and
returns its copy with <tt class="docutils literal"><span class="pre">df2</span></tt> appended.</p>
</div>
</div>
<div class="section" id="ignoring-indexes-on-the-concatenation-axis">
<span id="merging-ignore-index"></span><h3>Ignoring indexes on the concatenation axis<a class="headerlink" href="#ignoring-indexes-on-the-concatenation-axis" title="Permalink to this headline">¶</a></h3>
<p>For DataFrames which don&#8217;t have a meaningful index, you may wish to append them
and ignore the fact that they may have overlapping indexes:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [29]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">])</span>

<span class="gp">In [30]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">])</span>

<span class="gp">In [31]: </span><span class="n">df1</span>
<span class="gr">Out[31]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0  0.084844  0.432390  1.519970 -0.493662</span>
<span class="go">1  0.600178  0.274230  0.132885 -0.023688</span>
<span class="go">2  2.410179  1.450520  0.206053 -0.251905</span>
<span class="go">3 -2.213588  1.063327  1.266143  0.299368</span>
<span class="go">4 -0.863838  0.408204 -1.048089 -0.025747</span>
<span class="go">5 -0.988387  0.094055  1.262731  1.289997</span>

<span class="go">[6 rows x 4 columns]</span>

<span class="gp">In [32]: </span><span class="n">df2</span>
<span class="gr">Out[32]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0  0.082423 -0.055758  0.536580 -0.489682</span>
<span class="go">1  0.369374 -0.034571 -2.484478 -0.281461</span>
<span class="go">2  0.030711  0.109121  1.126203 -0.977349</span>

<span class="go">[3 rows x 4 columns]</span>
</pre></div>
</div>
<p>To do this, use the <tt class="docutils literal"><span class="pre">ignore_index</span></tt> argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [33]: </span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gr">Out[33]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0  0.084844  0.432390  1.519970 -0.493662</span>
<span class="go">1  0.600178  0.274230  0.132885 -0.023688</span>
<span class="go">2  2.410179  1.450520  0.206053 -0.251905</span>
<span class="go">3 -2.213588  1.063327  1.266143  0.299368</span>
<span class="go">4 -0.863838  0.408204 -1.048089 -0.025747</span>
<span class="go">5 -0.988387  0.094055  1.262731  1.289997</span>
<span class="go">6  0.082423 -0.055758  0.536580 -0.489682</span>
<span class="go">7  0.369374 -0.034571 -2.484478 -0.281461</span>
<span class="go">8  0.030711  0.109121  1.126203 -0.977349</span>

<span class="go">[9 rows x 4 columns]</span>
</pre></div>
</div>
<p>This is also a valid argument to <tt class="docutils literal"><span class="pre">DataFrame.append</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [34]: </span><span class="n">df1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gr">Out[34]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0  0.084844  0.432390  1.519970 -0.493662</span>
<span class="go">1  0.600178  0.274230  0.132885 -0.023688</span>
<span class="go">2  2.410179  1.450520  0.206053 -0.251905</span>
<span class="go">3 -2.213588  1.063327  1.266143  0.299368</span>
<span class="go">4 -0.863838  0.408204 -1.048089 -0.025747</span>
<span class="go">5 -0.988387  0.094055  1.262731  1.289997</span>
<span class="go">6  0.082423 -0.055758  0.536580 -0.489682</span>
<span class="go">7  0.369374 -0.034571 -2.484478 -0.281461</span>
<span class="go">8  0.030711  0.109121  1.126203 -0.977349</span>

<span class="go">[9 rows x 4 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="more-concatenating-with-group-keys">
<h3>More concatenating with group keys<a class="headerlink" href="#more-concatenating-with-group-keys" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s consider a variation on the first example presented:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [35]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="gp">In [36]: </span><span class="n">df</span>
<span class="gr">Out[36]: </span>
<span class="go">          0         1         2         3</span>
<span class="go">0  1.474071 -0.064034 -1.282782  0.781836</span>
<span class="go">1 -1.071357  0.441153  2.353925  0.583787</span>
<span class="go">2  0.221471 -0.744471  0.758527  1.729689</span>
<span class="go">3 -0.964980 -0.845696 -1.340896  1.846883</span>
<span class="go">4 -1.328865  1.682706 -1.717693  0.888782</span>
<span class="go">5  0.228440  0.901805  1.171216  0.520260</span>
<span class="go">6 -1.197071 -1.066969 -0.303421 -0.858447</span>
<span class="go">7  0.306996 -0.028665  0.384316  1.574159</span>
<span class="go">8  1.588931  0.476720  0.473424 -0.242861</span>
<span class="go">9 -0.014805 -0.284319  0.650776 -1.461665</span>

<span class="go">[10 rows x 4 columns]</span>

<span class="c"># break it into pieces</span>
<span class="gp">In [37]: </span><span class="n">pieces</span> <span class="o">=</span> <span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]]</span>

<span class="gp">In [38]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;three&#39;</span><span class="p">])</span>

<span class="gp">In [39]: </span><span class="n">result</span>
<span class="gr">Out[39]: </span>
<span class="go">        one                 two     three</span>
<span class="go">          0         1         2         3</span>
<span class="go">0  1.474071 -0.064034 -1.282782  0.781836</span>
<span class="go">1 -1.071357  0.441153  2.353925  0.583787</span>
<span class="go">2  0.221471 -0.744471  0.758527  1.729689</span>
<span class="go">3 -0.964980 -0.845696 -1.340896  1.846883</span>
<span class="go">4 -1.328865  1.682706 -1.717693  0.888782</span>
<span class="go">5  0.228440  0.901805  1.171216  0.520260</span>
<span class="go">6 -1.197071 -1.066969 -0.303421 -0.858447</span>
<span class="go">7  0.306996 -0.028665  0.384316  1.574159</span>
<span class="go">8  1.588931  0.476720  0.473424 -0.242861</span>
<span class="go">9 -0.014805 -0.284319  0.650776 -1.461665</span>

<span class="go">[10 rows x 4 columns]</span>
</pre></div>
</div>
<p>You can also pass a dict to <tt class="docutils literal"><span class="pre">concat</span></tt> in which case the dict keys will be used
for the <tt class="docutils literal"><span class="pre">keys</span></tt> argument (unless other keys are specified):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [40]: </span><span class="n">pieces</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;one&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
<span class="gp">   ....:</span>           <span class="s">&#39;two&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
<span class="gp">   ....:</span>           <span class="s">&#39;three&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]}</span>
<span class="gp">   ....:</span> 

<span class="gp">In [41]: </span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gr">Out[41]: </span>
<span class="go">        one               three       two</span>
<span class="go">          0         1         3         2</span>
<span class="go">0  1.474071 -0.064034  0.781836 -1.282782</span>
<span class="go">1 -1.071357  0.441153  0.583787  2.353925</span>
<span class="go">2  0.221471 -0.744471  1.729689  0.758527</span>
<span class="go">3 -0.964980 -0.845696  1.846883 -1.340896</span>
<span class="go">4 -1.328865  1.682706  0.888782 -1.717693</span>
<span class="go">5  0.228440  0.901805  0.520260  1.171216</span>
<span class="go">6 -1.197071 -1.066969 -0.858447 -0.303421</span>
<span class="go">7  0.306996 -0.028665  1.574159  0.384316</span>
<span class="go">8  1.588931  0.476720 -0.242861  0.473424</span>
<span class="go">9 -0.014805 -0.284319 -1.461665  0.650776</span>

<span class="go">[10 rows x 4 columns]</span>

<span class="gp">In [42]: </span><span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;three&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">])</span>
<span class="gr">Out[42]: </span>
<span class="go">                2         3</span>
<span class="go">three 0       NaN  0.781836</span>
<span class="go">      1       NaN  0.583787</span>
<span class="go">      2       NaN  1.729689</span>
<span class="go">      3       NaN  1.846883</span>
<span class="go">      4       NaN  0.888782</span>
<span class="go">      5       NaN  0.520260</span>
<span class="go">      6       NaN -0.858447</span>
<span class="go">      7       NaN  1.574159</span>
<span class="go">      8       NaN -0.242861</span>
<span class="go">      9       NaN -1.461665</span>
<span class="go">two   0 -1.282782       NaN</span>
<span class="go">      1  2.353925       NaN</span>
<span class="go">      2  0.758527       NaN</span>
<span class="go">      3 -1.340896       NaN</span>
<span class="go">      4 -1.717693       NaN</span>
<span class="go">              ...       ...</span>

<span class="go">[20 rows x 2 columns]</span>
</pre></div>
</div>
<p>The MultiIndex created has levels that are constructed from the passed keys and
the columns of the DataFrame pieces:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [43]: </span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">levels</span>
<span class="gr">Out[43]: </span><span class="n">FrozenList</span><span class="p">([[</span><span class="s">u&#39;one&#39;</span><span class="p">,</span> <span class="s">u&#39;two&#39;</span><span class="p">,</span> <span class="s">u&#39;three&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<p>If you wish to specify other levels (as will occasionally be the case), you can
do so using the <tt class="docutils literal"><span class="pre">levels</span></tt> argument:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [44]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">concat</span><span class="p">(</span><span class="n">pieces</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;three&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                 <span class="n">levels</span><span class="o">=</span><span class="p">[[</span><span class="s">&#39;three&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;zero&#39;</span><span class="p">]],</span>
<span class="gp">   ....:</span>                 <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;group_key&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [45]: </span><span class="n">result</span>
<span class="gr">Out[45]: </span>
<span class="go">group_key       one                 two     three</span>
<span class="go">                  0         1         2         3</span>
<span class="go">0          1.474071 -0.064034 -1.282782  0.781836</span>
<span class="go">1         -1.071357  0.441153  2.353925  0.583787</span>
<span class="go">2          0.221471 -0.744471  0.758527  1.729689</span>
<span class="go">3         -0.964980 -0.845696 -1.340896  1.846883</span>
<span class="go">4         -1.328865  1.682706 -1.717693  0.888782</span>
<span class="go">5          0.228440  0.901805  1.171216  0.520260</span>
<span class="go">6         -1.197071 -1.066969 -0.303421 -0.858447</span>
<span class="go">7          0.306996 -0.028665  0.384316  1.574159</span>
<span class="go">8          1.588931  0.476720  0.473424 -0.242861</span>
<span class="go">9         -0.014805 -0.284319  0.650776 -1.461665</span>

<span class="go">[10 rows x 4 columns]</span>

<span class="gp">In [46]: </span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">levels</span>
<span class="gr">Out[46]: </span><span class="n">FrozenList</span><span class="p">([[</span><span class="s">u&#39;three&#39;</span><span class="p">,</span> <span class="s">u&#39;two&#39;</span><span class="p">,</span> <span class="s">u&#39;one&#39;</span><span class="p">,</span> <span class="s">u&#39;zero&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<p>Yes, this is fairly esoteric, but is actually necessary for implementing things
like GroupBy where the order of a categorical variable is meaningful.</p>
</div>
<div class="section" id="appending-rows-to-a-dataframe">
<span id="merging-append-row"></span><h3>Appending rows to a DataFrame<a class="headerlink" href="#appending-rows-to-a-dataframe" title="Permalink to this headline">¶</a></h3>
<p>While not especially efficient (since a new object must be created), you can
append a single row to a DataFrame by passing a Series or dict to <tt class="docutils literal"><span class="pre">append</span></tt>,
which returns a new DataFrame as above.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [47]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">])</span>

<span class="gp">In [48]: </span><span class="n">df</span>
<span class="gr">Out[48]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0 -1.137707 -0.891060 -0.693921  1.613616</span>
<span class="go">1  0.464000  0.227371 -0.496922  0.306389</span>
<span class="go">2 -2.290613 -1.134623 -1.561819 -0.260838</span>
<span class="go">3  0.281957  1.523962 -0.902937  0.068159</span>
<span class="go">4 -0.057873 -0.368204 -1.144073  0.861209</span>
<span class="go">5  0.800193  0.782098 -1.069094 -1.099248</span>
<span class="go">6  0.255269  0.009750  0.661084  0.379319</span>
<span class="go">7 -0.008434  1.952541 -1.056652  0.533946</span>

<span class="go">[8 rows x 4 columns]</span>

<span class="gp">In [49]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="gp">In [50]: </span><span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gr">Out[50]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0 -1.137707 -0.891060 -0.693921  1.613616</span>
<span class="go">1  0.464000  0.227371 -0.496922  0.306389</span>
<span class="go">2 -2.290613 -1.134623 -1.561819 -0.260838</span>
<span class="go">3  0.281957  1.523962 -0.902937  0.068159</span>
<span class="go">4 -0.057873 -0.368204 -1.144073  0.861209</span>
<span class="go">5  0.800193  0.782098 -1.069094 -1.099248</span>
<span class="go">6  0.255269  0.009750  0.661084  0.379319</span>
<span class="go">7 -0.008434  1.952541 -1.056652  0.533946</span>
<span class="go">8  0.281957  1.523962 -0.902937  0.068159</span>

<span class="go">[9 rows x 4 columns]</span>
</pre></div>
</div>
<p>You should use <tt class="docutils literal"><span class="pre">ignore_index</span></tt> with this method to instruct DataFrame to
discard its index. If you wish to preserve the index, you should construct an
appropriately-indexed DataFrame and append or concatenate those objects.</p>
<p>You can also pass a list of dicts or Series:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [51]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="gp">   ....:</span>                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="s">&#39;qux&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [52]: </span><span class="n">dicts</span> <span class="o">=</span> <span class="p">[{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">&#39;baz&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">&#39;peekaboo&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
<span class="gp">   ....:</span>          <span class="p">{</span><span class="s">&#39;foo&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s">&#39;baz&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s">&#39;peekaboo&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">}]</span>
<span class="gp">   ....:</span> 

<span class="gp">In [53]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dicts</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">In [54]: </span><span class="n">result</span>
<span class="gr">Out[54]: </span>
<span class="go">        bar       baz       foo  peekaboo       qux</span>
<span class="go">0  0.040403 -0.507516 -1.226970       NaN -0.230096</span>
<span class="go">1 -1.934370 -1.652499  0.394500       NaN  1.488753</span>
<span class="go">2  0.576897  1.146000 -0.896484       NaN  1.487349</span>
<span class="go">3  2.121453  0.597701  0.604603       NaN  0.563700</span>
<span class="go">4 -1.057909  1.375020  0.967661       NaN -0.928797</span>
<span class="go">5  2.000000  3.000000  1.000000         4       NaN</span>
<span class="go">6  6.000000  7.000000  5.000000         8       NaN</span>

<span class="go">[7 rows x 5 columns]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="database-style-dataframe-joining-merging">
<span id="merging-join"></span><h2>Database-style DataFrame joining/merging<a class="headerlink" href="#database-style-dataframe-joining-merging" title="Permalink to this headline">¶</a></h2>
<p>pandas has full-featured, <strong>high performance</strong> in-memory join operations
idiomatically very similar to relational databases like SQL. These methods
perform significantly better (in some cases well over an order of magnitude
better) than other open source implementations (like <tt class="docutils literal"><span class="pre">base::merge.data.frame</span></tt>
in R). The reason for this is careful algorithmic design and internal layout of
the data in DataFrame.</p>
<p>See the <a class="reference internal" href="cookbook.html#cookbook-merge"><em>cookbook</em></a> for some advanced strategies.</p>
<p>Users who are familiar with SQL but new to pandas might be interested in a
<a class="reference internal" href="comparison_with_sql.html#compare-with-sql-join"><em>comparison with SQL</em></a>.</p>
<p>pandas provides a single function, <tt class="docutils literal"><span class="pre">merge</span></tt>, as the entry point for all
standard database join operations between DataFrame objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
      <span class="n">left_index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
      <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;_x&#39;</span><span class="p">,</span> <span class="s">&#39;_y&#39;</span><span class="p">),</span> <span class="n">copy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Here&#8217;s a description of what each argument is for:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">left</span></tt>: A DataFrame object</li>
<li><tt class="docutils literal"><span class="pre">right</span></tt>: Another DataFrame object</li>
<li><tt class="docutils literal"><span class="pre">on</span></tt>: Columns (names) to join on. Must be found in both the left and
right DataFrame objects. If not passed and <tt class="docutils literal"><span class="pre">left_index</span></tt> and
<tt class="docutils literal"><span class="pre">right_index</span></tt> are <tt class="docutils literal"><span class="pre">False</span></tt>, the intersection of the columns in the
DataFrames will be inferred to be the join keys</li>
<li><tt class="docutils literal"><span class="pre">left_on</span></tt>: Columns from the left DataFrame to use as keys. Can either be
column names or arrays with length equal to the length of the DataFrame</li>
<li><tt class="docutils literal"><span class="pre">right_on</span></tt>: Columns from the right DataFrame to use as keys. Can either be
column names or arrays with length equal to the length of the DataFrame</li>
<li><tt class="docutils literal"><span class="pre">left_index</span></tt>: If <tt class="docutils literal"><span class="pre">True</span></tt>, use the index (row labels) from the left
DataFrame as its join key(s). In the case of a DataFrame with a MultiIndex
(hierarchical), the number of levels must match the number of join keys
from the right DataFrame</li>
<li><tt class="docutils literal"><span class="pre">right_index</span></tt>: Same usage as <tt class="docutils literal"><span class="pre">left_index</span></tt> for the right DataFrame</li>
<li><tt class="docutils literal"><span class="pre">how</span></tt>: One of <tt class="docutils literal"><span class="pre">'left'</span></tt>, <tt class="docutils literal"><span class="pre">'right'</span></tt>, <tt class="docutils literal"><span class="pre">'outer'</span></tt>, <tt class="docutils literal"><span class="pre">'inner'</span></tt>. Defaults
to <tt class="docutils literal"><span class="pre">inner</span></tt>. See below for more detailed description of each method</li>
<li><tt class="docutils literal"><span class="pre">sort</span></tt>: Sort the result DataFrame by the join keys in lexicographical
order. Defaults to <tt class="docutils literal"><span class="pre">True</span></tt>, setting to <tt class="docutils literal"><span class="pre">False</span></tt> will improve performance
substantially in many cases</li>
<li><tt class="docutils literal"><span class="pre">suffixes</span></tt>: A tuple of string suffixes to apply to overlapping
columns. Defaults to <tt class="docutils literal"><span class="pre">('_x',</span> <span class="pre">'_y')</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">copy</span></tt>: Always copy data (default <tt class="docutils literal"><span class="pre">True</span></tt>) from the passed DataFrame
objects, even when reindexing is not necessary. Cannot be avoided in many
cases but may improve performance / memory usage. The cases where copying
can be avoided are somewhat pathological but this option is provided
nonetheless.</li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">merge</span></tt> is a function in the pandas namespace, and it is also available as a
DataFrame instance method, with the calling DataFrame being implicitly
considered the left object in the join.</p>
<p>The related <tt class="docutils literal"><span class="pre">DataFrame.join</span></tt> method, uses <tt class="docutils literal"><span class="pre">merge</span></tt> internally for the
index-on-index and index-on-column(s) joins, but <em>joins on indexes</em> by default
rather than trying to join on common columns (the default behavior for
<tt class="docutils literal"><span class="pre">merge</span></tt>). If you are joining on index, you may wish to use <tt class="docutils literal"><span class="pre">DataFrame.join</span></tt>
to save yourself some typing.</p>
<div class="section" id="brief-primer-on-merge-methods-relational-algebra">
<h3>Brief primer on merge methods (relational algebra)<a class="headerlink" href="#brief-primer-on-merge-methods-relational-algebra" title="Permalink to this headline">¶</a></h3>
<p>Experienced users of relational databases like SQL will be familiar with the
terminology used to describe join operations between two SQL-table like
structures (DataFrame objects). There are several cases to consider which are
very important to understand:</p>
<blockquote>
<div><ul class="simple">
<li><strong>one-to-one</strong> joins: for example when joining two DataFrame objects on
their indexes (which must contain unique values)</li>
<li><strong>many-to-one</strong> joins: for example when joining an index (unique) to one or
more columns in a DataFrame</li>
<li><strong>many-to-many</strong> joins: joining columns on columns.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When joining columns on columns (potentially a many-to-many join), any
indexes on the passed DataFrame objects <strong>will be discarded</strong>.</p>
</div>
<p>It is worth spending some time understanding the result of the <strong>many-to-many</strong>
join case. In SQL / standard relational algebra, if a key combination appears
more than once in both tables, the resulting table will have the <strong>Cartesian
product</strong> of the associated data. Here is a very basic example with one unique
key combination:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [55]: </span><span class="n">left</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span> <span class="s">&#39;lval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [56]: </span><span class="n">right</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span> <span class="s">&#39;rval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="gp">In [57]: </span><span class="n">left</span>
<span class="gr">Out[57]: </span>
<span class="go">   key  lval</span>
<span class="go">0  foo     1</span>
<span class="go">1  foo     2</span>

<span class="go">[2 rows x 2 columns]</span>

<span class="gp">In [58]: </span><span class="n">right</span>
<span class="gr">Out[58]: </span>
<span class="go">   key  rval</span>
<span class="go">0  foo     4</span>
<span class="go">1  foo     5</span>

<span class="go">[2 rows x 2 columns]</span>

<span class="gp">In [59]: </span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">&#39;key&#39;</span><span class="p">)</span>
<span class="gr">Out[59]: </span>
<span class="go">   key  lval  rval</span>
<span class="go">0  foo     1     4</span>
<span class="go">1  foo     1     5</span>
<span class="go">2  foo     2     4</span>
<span class="go">3  foo     2     5</span>

<span class="go">[4 rows x 3 columns]</span>
</pre></div>
</div>
<p>Here is a more complicated example with multiple join keys:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [60]: </span><span class="n">left</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                   <span class="s">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                   <span class="s">&#39;lval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">   ....:</span> 

<span class="gp">In [61]: </span><span class="n">right</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                    <span class="s">&#39;key2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                    <span class="s">&#39;rval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]})</span>
<span class="gp">   ....:</span> 

<span class="gp">In [62]: </span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;outer&#39;</span><span class="p">)</span>
<span class="gr">Out[62]: </span>
<span class="go">  key1 key2  lval  rval</span>
<span class="go">0  foo  one     1     4</span>
<span class="go">1  foo  one     1     5</span>
<span class="go">2  foo  two     2   NaN</span>
<span class="go">3  bar  one     3     6</span>
<span class="go">4  bar  two   NaN     7</span>

<span class="go">[5 rows x 4 columns]</span>

<span class="gp">In [63]: </span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;inner&#39;</span><span class="p">)</span>
<span class="gr">Out[63]: </span>
<span class="go">  key1 key2  lval  rval</span>
<span class="go">0  foo  one     1     4</span>
<span class="go">1  foo  one     1     5</span>
<span class="go">2  bar  one     3     6</span>

<span class="go">[3 rows x 4 columns]</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">how</span></tt> argument to <tt class="docutils literal"><span class="pre">merge</span></tt> specifies how to determine which keys are to
be included in the resulting table. If a key combination <strong>does not appear</strong> in
either the left or right tables, the values in the joined table will be
<tt class="docutils literal"><span class="pre">NA</span></tt>. Here is a summary of the <tt class="docutils literal"><span class="pre">how</span></tt> options and their SQL equivalent names:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="20%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Merge method</th>
<th class="head">SQL Join Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">left</span></tt></td>
<td><tt class="docutils literal"><span class="pre">LEFT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></tt></td>
<td>Use keys from left frame only</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">right</span></tt></td>
<td><tt class="docutils literal"><span class="pre">RIGHT</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></tt></td>
<td>Use keys from right frame only</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">outer</span></tt></td>
<td><tt class="docutils literal"><span class="pre">FULL</span> <span class="pre">OUTER</span> <span class="pre">JOIN</span></tt></td>
<td>Use union of keys from both frames</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">inner</span></tt></td>
<td><tt class="docutils literal"><span class="pre">INNER</span> <span class="pre">JOIN</span></tt></td>
<td>Use intersection of keys from both frames</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="joining-on-index">
<span id="merging-join-index"></span><h3>Joining on index<a class="headerlink" href="#joining-on-index" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">DataFrame.join</span></tt> is a convenient method for combining the columns of two
potentially differently-indexed DataFrames into a single result DataFrame. Here
is a very basic example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [64]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;C&#39;</span><span class="p">,</span><span class="s">&#39;D&#39;</span><span class="p">])</span>

<span class="gp">In [65]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">]]</span>

<span class="gp">In [66]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">]]</span>

<span class="gp">In [67]: </span><span class="n">df1</span>
<span class="gr">Out[67]: </span>
<span class="go">          A         B</span>
<span class="go">1 -2.461467 -1.553902</span>
<span class="go">2  1.771740 -0.670027</span>
<span class="go">3 -3.201750  0.792716</span>
<span class="go">4 -0.747169 -0.309038</span>
<span class="go">5  0.936527  1.255746</span>
<span class="go">6  0.062297 -0.110388</span>
<span class="go">7  0.077849  0.629498</span>

<span class="go">[7 rows x 2 columns]</span>

<span class="gp">In [68]: </span><span class="n">df2</span>
<span class="gr">Out[68]: </span>
<span class="go">          C         D</span>
<span class="go">0  0.377953  0.493672</span>
<span class="go">1  2.015523 -1.833722</span>
<span class="go">2  0.049307 -0.521493</span>
<span class="go">3  0.146111  1.903247</span>
<span class="go">4  0.393876  1.861468</span>
<span class="go">5 -2.655452  1.219492</span>

<span class="go">[6 rows x 2 columns]</span>

<span class="gp">In [69]: </span><span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[69]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492</span>
<span class="go">6  0.062297 -0.110388       NaN       NaN</span>
<span class="go">7  0.077849  0.629498       NaN       NaN</span>

<span class="go">[7 rows x 4 columns]</span>

<span class="gp">In [70]: </span><span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;outer&#39;</span><span class="p">)</span>
<span class="gr">Out[70]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0       NaN       NaN  0.377953  0.493672</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492</span>
<span class="go">6  0.062297 -0.110388       NaN       NaN</span>
<span class="go">7  0.077849  0.629498       NaN       NaN</span>

<span class="go">[8 rows x 4 columns]</span>

<span class="gp">In [71]: </span><span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;inner&#39;</span><span class="p">)</span>
<span class="gr">Out[71]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492</span>

<span class="go">[5 rows x 4 columns]</span>
</pre></div>
</div>
<p>The data alignment here is on the indexes (row labels). This same behavior can
be achieved using <tt class="docutils literal"><span class="pre">merge</span></tt> plus additional arguments instructing it to use the
indexes:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [72]: </span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;outer&#39;</span><span class="p">)</span>
<span class="gr">Out[72]: </span>
<span class="go">          A         B         C         D</span>
<span class="go">0       NaN       NaN  0.377953  0.493672</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492</span>
<span class="go">6  0.062297 -0.110388       NaN       NaN</span>
<span class="go">7  0.077849  0.629498       NaN       NaN</span>

<span class="go">[8 rows x 4 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="joining-key-columns-on-an-index">
<h3>Joining key columns on an index<a class="headerlink" href="#joining-key-columns-on-an-index" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">join</span></tt> takes an optional <tt class="docutils literal"><span class="pre">on</span></tt> argument which may be a column or multiple
column names, which specifies that the passed DataFrame is to be aligned on
that column in the DataFrame. These two function calls are completely
equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">left</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">key_or_keys</span><span class="p">)</span>
<span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">key_or_keys</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
      <span class="n">how</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Obviously you can choose whichever form you find more convenient. For
many-to-one joins (where one of the DataFrame&#8217;s is already indexed by the join
key), using <tt class="docutils literal"><span class="pre">join</span></tt> may be more convenient. Here is a simple example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [73]: </span><span class="n">df</span><span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>

<span class="gp">In [74]: </span><span class="n">to_join</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;j1&#39;</span><span class="p">,</span> <span class="s">&#39;j2&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [75]: </span><span class="n">df</span>
<span class="gr">Out[75]: </span>
<span class="go">          A         B         C         D  key</span>
<span class="go">0 -0.308853 -0.681087  0.377953  0.493672  foo</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722  bar</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493  foo</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247  bar</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468  foo</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492  bar</span>
<span class="go">6  0.062297 -0.110388 -1.184357 -0.558081  foo</span>
<span class="go">7  0.077849  0.629498 -1.035260 -0.438229  bar</span>

<span class="go">[8 rows x 5 columns]</span>

<span class="gp">In [76]: </span><span class="n">to_join</span>
<span class="gr">Out[76]: </span>
<span class="go">           j1        j2</span>
<span class="go">bar  0.503703  0.413086</span>
<span class="go">foo -1.139050  0.660342</span>

<span class="go">[2 rows x 2 columns]</span>

<span class="gp">In [77]: </span><span class="n">df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">to_join</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">&#39;key&#39;</span><span class="p">)</span>
<span class="gr">Out[77]: </span>
<span class="go">          A         B         C         D  key        j1        j2</span>
<span class="go">0 -0.308853 -0.681087  0.377953  0.493672  foo -1.139050  0.660342</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722  bar  0.503703  0.413086</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493  foo -1.139050  0.660342</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247  bar  0.503703  0.413086</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468  foo -1.139050  0.660342</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492  bar  0.503703  0.413086</span>
<span class="go">6  0.062297 -0.110388 -1.184357 -0.558081  foo -1.139050  0.660342</span>
<span class="go">7  0.077849  0.629498 -1.035260 -0.438229  bar  0.503703  0.413086</span>

<span class="go">[8 rows x 7 columns]</span>

<span class="gp">In [78]: </span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">to_join</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">   ....:</span>       <span class="n">how</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">   ....:</span> 
<span class="gr">Out[78]: </span>
<span class="go">          A         B         C         D  key        j1        j2</span>
<span class="go">0 -0.308853 -0.681087  0.377953  0.493672  foo -1.139050  0.660342</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722  bar  0.503703  0.413086</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493  foo -1.139050  0.660342</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247  bar  0.503703  0.413086</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468  foo -1.139050  0.660342</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492  bar  0.503703  0.413086</span>
<span class="go">6  0.062297 -0.110388 -1.184357 -0.558081  foo -1.139050  0.660342</span>
<span class="go">7  0.077849  0.629498 -1.035260 -0.438229  bar  0.503703  0.413086</span>

<span class="go">[8 rows x 7 columns]</span>
</pre></div>
</div>
<p id="merging-multikey-join">To join on multiple keys, the passed DataFrame must have a <tt class="docutils literal"><span class="pre">MultiIndex</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [79]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">MultiIndex</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="p">[[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="s">&#39;qux&#39;</span><span class="p">],</span>
<span class="gp">   ....:</span>                            <span class="p">[</span><span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;three&#39;</span><span class="p">]],</span>
<span class="gp">   ....:</span>                    <span class="n">labels</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">   ....:</span>                            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
<span class="gp">   ....:</span>                    <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;first&#39;</span><span class="p">,</span> <span class="s">&#39;second&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="gp">In [80]: </span><span class="n">to_join</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
<span class="gp">   ....:</span>                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;j_one&#39;</span><span class="p">,</span> <span class="s">&#39;j_two&#39;</span><span class="p">,</span> <span class="s">&#39;j_three&#39;</span><span class="p">])</span>
<span class="gp">   ....:</span> 

<span class="c"># a little relevant example with NAs</span>
<span class="gp">In [81]: </span><span class="n">key1</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;bar&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="s">&#39;qux&#39;</span><span class="p">,</span>
<span class="gp">   ....:</span>         <span class="s">&#39;qux&#39;</span><span class="p">,</span> <span class="s">&#39;snap&#39;</span><span class="p">]</span>
<span class="gp">   ....:</span> 

<span class="gp">In [82]: </span><span class="n">key2</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;three&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span> <span class="s">&#39;two&#39;</span><span class="p">,</span>
<span class="gp">   ....:</span>         <span class="s">&#39;three&#39;</span><span class="p">,</span> <span class="s">&#39;one&#39;</span><span class="p">]</span>
<span class="gp">   ....:</span> 

<span class="gp">In [83]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">key1</span><span class="p">))</span>

<span class="gp">In [84]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key1&#39;</span> <span class="p">:</span> <span class="n">key1</span><span class="p">,</span> <span class="s">&#39;key2&#39;</span> <span class="p">:</span> <span class="n">key2</span><span class="p">,</span>
<span class="gp">   ....:</span>                   <span class="s">&#39;data&#39;</span> <span class="p">:</span> <span class="n">data</span><span class="p">})</span>
<span class="gp">   ....:</span> 

<span class="gp">In [85]: </span><span class="n">data</span>
<span class="gr">Out[85]: </span>
<span class="go">       data  key1   key2</span>
<span class="go">0 -1.004168   bar    two</span>
<span class="go">1 -1.377627   bar    one</span>
<span class="go">2  0.499281   bar  three</span>
<span class="go">3 -1.405256   foo    one</span>
<span class="go">4  0.162565   foo    two</span>
<span class="go">5 -0.067785   baz    one</span>
<span class="go">6 -1.260006   baz    two</span>
<span class="go">7 -1.132896   qux    two</span>
<span class="go">8 -2.006481   qux  three</span>
<span class="go">9  0.301016  snap    one</span>

<span class="go">[10 rows x 3 columns]</span>

<span class="gp">In [86]: </span><span class="n">to_join</span>
<span class="gr">Out[86]: </span>
<span class="go">                 j_one     j_two   j_three</span>
<span class="go">first second                              </span>
<span class="go">foo   one     0.464794 -0.309337 -0.649593</span>
<span class="go">      two     0.683758 -0.643834  0.421287</span>
<span class="go">      three   1.032814 -1.290493  0.787872</span>
<span class="go">bar   one     1.515707 -0.276487 -0.223762</span>
<span class="go">      two     1.397431  1.503874 -0.478905</span>
<span class="go">baz   two    -0.135950 -0.730327 -0.033277</span>
<span class="go">      three   0.281151 -1.298915 -2.819487</span>
<span class="go">qux   one    -0.851985 -1.106952 -0.937731</span>
<span class="go">      two    -1.537770  0.555759 -2.277282</span>
<span class="go">      three  -0.390201  1.207122  0.178690</span>

<span class="go">[10 rows x 3 columns]</span>
</pre></div>
</div>
<p>Now this can be joined by passing the two key column names:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [87]: </span><span class="n">data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">to_join</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;key1&#39;</span><span class="p">,</span> <span class="s">&#39;key2&#39;</span><span class="p">])</span>
<span class="gr">Out[87]: </span>
<span class="go">       data  key1   key2     j_one     j_two   j_three</span>
<span class="go">0 -1.004168   bar    two  1.397431  1.503874 -0.478905</span>
<span class="go">1 -1.377627   bar    one  1.515707 -0.276487 -0.223762</span>
<span class="go">2  0.499281   bar  three       NaN       NaN       NaN</span>
<span class="go">3 -1.405256   foo    one  0.464794 -0.309337 -0.649593</span>
<span class="go">4  0.162565   foo    two  0.683758 -0.643834  0.421287</span>
<span class="go">5 -0.067785   baz    one       NaN       NaN       NaN</span>
<span class="go">6 -1.260006   baz    two -0.135950 -0.730327 -0.033277</span>
<span class="go">7 -1.132896   qux    two -1.537770  0.555759 -2.277282</span>
<span class="go">8 -2.006481   qux  three -0.390201  1.207122  0.178690</span>
<span class="go">9  0.301016  snap    one       NaN       NaN       NaN</span>

<span class="go">[10 rows x 6 columns]</span>
</pre></div>
</div>
<p id="merging-df-inner-join">The default for <tt class="docutils literal"><span class="pre">DataFrame.join</span></tt> is to perform a left join (essentially a
&#8220;VLOOKUP&#8221; operation, for Excel users), which uses only the keys found in the
calling DataFrame. Other join types, for example inner join, can be just as
easily performed:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [88]: </span><span class="n">data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">to_join</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;key1&#39;</span><span class="p">,</span> <span class="s">&#39;key2&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s">&#39;inner&#39;</span><span class="p">)</span>
<span class="gr">Out[88]: </span>
<span class="go">       data key1   key2     j_one     j_two   j_three</span>
<span class="go">0 -1.004168  bar    two  1.397431  1.503874 -0.478905</span>
<span class="go">1 -1.377627  bar    one  1.515707 -0.276487 -0.223762</span>
<span class="go">3 -1.405256  foo    one  0.464794 -0.309337 -0.649593</span>
<span class="go">4  0.162565  foo    two  0.683758 -0.643834  0.421287</span>
<span class="go">6 -1.260006  baz    two -0.135950 -0.730327 -0.033277</span>
<span class="go">7 -1.132896  qux    two -1.537770  0.555759 -2.277282</span>
<span class="go">8 -2.006481  qux  three -0.390201  1.207122  0.178690</span>

<span class="go">[7 rows x 6 columns]</span>
</pre></div>
</div>
<p>As you can see, this drops any rows where there was no match.</p>
</div>
<div class="section" id="overlapping-value-columns">
<h3>Overlapping value columns<a class="headerlink" href="#overlapping-value-columns" title="Permalink to this headline">¶</a></h3>
<p>The merge <tt class="docutils literal"><span class="pre">suffixes</span></tt> argument takes a tuple of list of strings to append to
overlapping column names in the input DataFrames to disambiguate the result
columns:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [89]: </span><span class="n">left</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [90]: </span><span class="n">right</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;foo&#39;</span><span class="p">,</span> <span class="s">&#39;foo&#39;</span><span class="p">],</span> <span class="s">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]})</span>

<span class="gp">In [91]: </span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;_left&#39;</span><span class="p">,</span> <span class="s">&#39;_right&#39;</span><span class="p">])</span>
<span class="gr">Out[91]: </span>
<span class="go">   key  value_left  value_right</span>
<span class="go">0  foo           1            4</span>
<span class="go">1  foo           1            5</span>
<span class="go">2  foo           2            4</span>
<span class="go">3  foo           2            5</span>

<span class="go">[4 rows x 3 columns]</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">DataFrame.join</span></tt> has <tt class="docutils literal"><span class="pre">lsuffix</span></tt> and <tt class="docutils literal"><span class="pre">rsuffix</span></tt> arguments which behave
similarly.</p>
</div>
<div class="section" id="merging-ordered-data">
<span id="merging-ordered-merge"></span><h3>Merging Ordered Data<a class="headerlink" href="#merging-ordered-data" title="Permalink to this headline">¶</a></h3>
<p>New in v0.8.0 is the ordered_merge function for combining time series and other
ordered data. In particular it has an optional <tt class="docutils literal"><span class="pre">fill_method</span></tt> keyword to
fill/interpolate missing data:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [92]: </span><span class="n">A</span>
<span class="gr">Out[92]: </span>
<span class="go">  group key  lvalue</span>
<span class="go">0     a   a       1</span>
<span class="go">1     a   c       2</span>
<span class="go">2     a   e       3</span>
<span class="go">3     b   a       1</span>
<span class="go">4     b   c       2</span>
<span class="go">5     b   e       3</span>

<span class="go">[6 rows x 3 columns]</span>

<span class="gp">In [93]: </span><span class="n">B</span>
<span class="gr">Out[93]: </span>
<span class="go">  key  rvalue</span>
<span class="go">0   b       1</span>
<span class="go">1   c       2</span>
<span class="go">2   d       3</span>

<span class="go">[3 rows x 2 columns]</span>

<span class="gp">In [94]: </span><span class="n">ordered_merge</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">fill_method</span><span class="o">=</span><span class="s">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">left_by</span><span class="o">=</span><span class="s">&#39;group&#39;</span><span class="p">)</span>
<span class="gr">Out[94]: </span>
<span class="go">  group key  lvalue  rvalue</span>
<span class="go">0     a   a       1     NaN</span>
<span class="go">1     a   b       1       1</span>
<span class="go">2     a   c       2       2</span>
<span class="go">3     a   d       2       3</span>
<span class="go">4     a   e       3       3</span>
<span class="go">5     b   a       1     NaN</span>
<span class="go">6     b   b       1       1</span>
<span class="go">7     b   c       2       2</span>
<span class="go">8     b   d       2       3</span>
<span class="go">9     b   e       3       3</span>

<span class="go">[10 rows x 4 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="joining-multiple-dataframe-or-panel-objects">
<span id="merging-multiple-join"></span><h3>Joining multiple DataFrame or Panel objects<a class="headerlink" href="#joining-multiple-dataframe-or-panel-objects" title="Permalink to this headline">¶</a></h3>
<p>A list or tuple of DataFrames can also be passed to <tt class="docutils literal"><span class="pre">DataFrame.join</span></tt> to join
them together on their indexes. The same is true for <tt class="docutils literal"><span class="pre">Panel.join</span></tt>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [95]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">]]</span>

<span class="gp">In [96]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">]]</span>

<span class="gp">In [97]: </span><span class="n">df3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[:,</span> <span class="p">[</span><span class="s">&#39;key&#39;</span><span class="p">]]</span>

<span class="gp">In [98]: </span><span class="n">df1</span>
<span class="gr">Out[98]: </span>
<span class="go">          A         B</span>
<span class="go">0 -0.308853 -0.681087</span>
<span class="go">1 -2.461467 -1.553902</span>
<span class="go">2  1.771740 -0.670027</span>
<span class="go">3 -3.201750  0.792716</span>
<span class="go">4 -0.747169 -0.309038</span>
<span class="go">5  0.936527  1.255746</span>
<span class="go">6  0.062297 -0.110388</span>
<span class="go">7  0.077849  0.629498</span>

<span class="go">[8 rows x 2 columns]</span>

<span class="gp">In [99]: </span><span class="n">df1</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">])</span>
<span class="gr">Out[99]: </span>
<span class="go">          A         B         C         D  key</span>
<span class="go">0 -0.308853 -0.681087  0.377953  0.493672  foo</span>
<span class="go">1 -2.461467 -1.553902  2.015523 -1.833722  bar</span>
<span class="go">2  1.771740 -0.670027  0.049307 -0.521493  foo</span>
<span class="go">3 -3.201750  0.792716  0.146111  1.903247  bar</span>
<span class="go">4 -0.747169 -0.309038  0.393876  1.861468  foo</span>
<span class="go">5  0.936527  1.255746 -2.655452  1.219492  bar</span>
<span class="go">6  0.062297 -0.110388 -1.184357 -0.558081  foo</span>
<span class="go">7  0.077849  0.629498 -1.035260 -0.438229  bar</span>

<span class="go">[8 rows x 5 columns]</span>
</pre></div>
</div>
</div>
<div class="section" id="merging-together-values-within-series-or-dataframe-columns">
<span id="merging-combine-first-update"></span><h3>Merging together values within Series or DataFrame columns<a class="headerlink" href="#merging-together-values-within-series-or-dataframe-columns" title="Permalink to this headline">¶</a></h3>
<p>Another fairly common situation is to have two like-indexed (or similarly
indexed) Series or DataFrame objects and wanting to &#8220;patch&#8221; values in one
object from values for matching indices in the other. Here is an example:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [100]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">([[</span><span class="n">nan</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">4.6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
<span class="gp">   .....:</span>                  <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="n">nan</span><span class="p">]])</span>
<span class="gp">   .....:</span> 

<span class="gp">In [101]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">([[</span><span class="o">-</span><span class="mf">42.6</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
<span class="gp">   .....:</span>                 <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">   .....:</span> 
</pre></div>
</div>
<p>For this, use the <tt class="docutils literal"><span class="pre">combine_first</span></tt> method:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [102]: </span><span class="n">df1</span><span class="o">.</span><span class="n">combine_first</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="gr">Out[102]: </span>
<span class="go">     0   1    2</span>
<span class="go">0  NaN   3  5.0</span>
<span class="go">1 -4.6 NaN -8.2</span>
<span class="go">2 -5.0   7  4.0</span>

<span class="go">[3 rows x 3 columns]</span>
</pre></div>
</div>
<p>Note that this method only takes values from the right DataFrame if they are
missing in the left DataFrame. A related method, <tt class="docutils literal"><span class="pre">update</span></tt>, alters non-NA
values inplace:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [103]: </span><span class="n">df1</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>

<span class="gp">In [104]: </span><span class="n">df1</span>
<span class="gr">Out[104]: </span>
<span class="go">      0    1    2</span>
<span class="go">0   NaN  3.0  5.0</span>
<span class="go">1 -42.6  NaN -8.2</span>
<span class="go">2  -5.0  1.6  4.0</span>

<span class="go">[3 rows x 3 columns]</span>
</pre></div>
</div>
</div>
</div>
</div>


                    </div>
                </div>
            </div>

            
            <div class="clearer"></div>
        </div>
    </div>
</div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="reshaping.html" title="Reshaping and Pivot Tables"
             >next</a> |</li>
        <li class="right" >
          <a href="groupby.html" title="Group By: split-apply-combine"
             >previous</a> |</li>
        <li><a href="index.html">pandas 0.13.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2014, the pandas development team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>