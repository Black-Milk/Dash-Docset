<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><title>scipy.optimize.anneal — SciPy v0.12 Reference Guide (DRAFT)</title><link href="../_static/scipy.css" rel="stylesheet" type="text/css"/><link href="../_static/pygments.css" rel="stylesheet" type="text/css"/><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script><script src="../_static/jquery.js" type="text/javascript"></script><script src="../_static/underscore.js" type="text/javascript"></script><script src="../_static/doctools.js" type="text/javascript"></script><link href="../index.html" rel="top" title="SciPy v0.12 Reference Guide (DRAFT)"/><link href="../optimize.html" rel="up" title="Optimization and root finding (scipy.optimize)"/><link href="scipy.optimize.basinhopping.html" rel="next" title="scipy.optimize.basinhopping"/><link href="scipy.optimize.nnls.html" rel="prev" title="scipy.optimize.nnls"/></head><body>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="../np-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="scipy.optimize.basinhopping.html" title="scipy.optimize.basinhopping">next</a> |</li>
<li class="right">
<a accesskey="P" href="scipy.optimize.nnls.html" title="scipy.optimize.nnls">previous</a> |</li>
<li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> »</li>
<li><a accesskey="U" href="../optimize.html">Optimization and root finding (<tt class="docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> »</li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="scipy-optimize-anneal">
<h1>scipy.optimize.anneal<a class="headerlink" href="#scipy-optimize-anneal" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.optimize.anneal"><a name="//apple_ref/cpp/func/scipy.optimize.anneal"></a>
<tt class="descclassname">scipy.optimize.</tt><tt class="descname">anneal</tt><big>(</big><em>func</em>, <em>x0</em>, <em>args=()</em>, <em>schedule='fast'</em>, <em>full_output=0</em>, <em>T0=None</em>, <em>Tf=1e-12</em>, <em>maxeval=None</em>, <em>maxaccept=None</em>, <em>maxiter=400</em>, <em>boltzmann=1.0</em>, <em>learn_rate=0.5</em>, <em>feps=1e-06</em>, <em>quench=1.0</em>, <em>m=1.0</em>, <em>n=1.0</em>, <em>lower=-100</em>, <em>upper=100</em>, <em>dwell=50</em>, <em>disp=True</em><big>)</big><a class="reference external" href="http://github.com/scipy/scipy/blob/v0.12.0/scipy/optimize/anneal.py#L156"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.optimize.anneal" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize a function using simulated annealing.</p>
<p>Schedule is a schedule class implementing the annealing schedule.
Available ones are ‘fast’, ‘cauchy’, ‘boltzmann’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>func</strong> : callable <tt class="docutils literal"><span class="pre">f(x,</span> <span class="pre">*args)</span></tt></p>
<blockquote>
<div><p>Function to be optimized.</p>
</div></blockquote>
<p><strong>x0</strong> : ndarray</p>
<blockquote>
<div><p>Initial guess.</p>
</div></blockquote>
<p><strong>args</strong> : tuple</p>
<blockquote>
<div><p>Extra parameters to <em class="xref py py-obj">func</em>.</p>
</div></blockquote>
<p><strong>schedule</strong> : base_schedule</p>
<blockquote>
<div><p>Annealing schedule to use (a class).</p>
</div></blockquote>
<p><strong>full_output</strong> : bool</p>
<blockquote>
<div><p>Whether to return optional outputs.</p>
</div></blockquote>
<p><strong>T0</strong> : float</p>
<blockquote>
<div><p>Initial Temperature (estimated as 1.2 times the largest
cost-function deviation over random points in the range).</p>
</div></blockquote>
<p><strong>Tf</strong> : float</p>
<blockquote>
<div><p>Final goal temperature.</p>
</div></blockquote>
<p><strong>maxeval</strong> : int</p>
<blockquote>
<div><p>Maximum function evaluations.</p>
</div></blockquote>
<p><strong>maxaccept</strong> : int</p>
<blockquote>
<div><p>Maximum changes to accept.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum cooling iterations.</p>
</div></blockquote>
<p><strong>learn_rate</strong> : float</p>
<blockquote>
<div><p>Scale constant for adjusting guesses.</p>
</div></blockquote>
<p><strong>boltzmann</strong> : float</p>
<blockquote>
<div><p>Boltzmann constant in acceptance test
(increase for less stringent test at each temperature).</p>
</div></blockquote>
<p><strong>feps</strong> : float</p>
<blockquote>
<div><p>Stopping relative error tolerance for the function value in
last four coolings.</p>
</div></blockquote>
<p><strong>quench, m, n</strong> : float</p>
<blockquote>
<div><p>Parameters to alter fast_sa schedule.</p>
</div></blockquote>
<p><strong>lower, upper</strong> : float or ndarray</p>
<blockquote>
<div><p>Lower and upper bounds on <em class="xref py py-obj">x</em>.</p>
</div></blockquote>
<p><strong>dwell</strong> : int</p>
<blockquote>
<div><p>The number of times to search the space at each temperature.</p>
</div></blockquote>
<p><strong>disp</strong> : bool</p>
<blockquote>
<div><p>Set to True to print convergence messages.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>xmin</strong> : ndarray</p>
<blockquote>
<div><p>Point giving smallest value found.</p>
</div></blockquote>
<p><strong>Jmin</strong> : float</p>
<blockquote>
<div><p>Minimum value of function found.</p>
</div></blockquote>
<p><strong>T</strong> : float</p>
<blockquote>
<div><p>Final temperature.</p>
</div></blockquote>
<p><strong>feval</strong> : int</p>
<blockquote>
<div><p>Number of function evaluations.</p>
</div></blockquote>
<p><strong>iters</strong> : int</p>
<blockquote>
<div><p>Number of cooling iterations.</p>
</div></blockquote>
<p><strong>accept</strong> : int</p>
<blockquote>
<div><p>Number of tests accepted.</p>
</div></blockquote>
<p><strong>retval</strong> : int</p>
<blockquote class="last">
<div><p>Flag indicating stopping condition:</p>
<blockquote>
<div><p>0 : Points no longer changing</p>
<p>1 : Cooled to final temperature</p>
<p>2 : Maximum function evaluations</p>
<p>3 : Maximum cooling iterations reached</p>
<p>4 : Maximum accepted query locations reached</p>
<p>5 : Final point not the minimum amongst encountered points</p>
</div></blockquote>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="scipy.optimize.minimize.html#scipy.optimize.minimize" title="scipy.optimize.minimize"><tt class="xref py py-obj docutils literal"><span class="pre">minimize</span></tt></a></dt>
<dd>Interface to minimization algorithms for multivariate functions. See the ‘Anneal’ <em class="xref py py-obj">method</em> in particular.</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Simulated annealing is a random algorithm which uses no derivative
information from the function being optimized. In practice it has
been more useful in discrete optimization than continuous
optimization, as there are usually better algorithms for continuous
optimization problems.</p>
<p>Some experimentation by trying the difference temperature
schedules and altering their parameters is likely required to
obtain good performance.</p>
<p>The randomness in the algorithm comes from random sampling in numpy.
To obtain the same results you can call numpy.random.seed with the
same seed immediately before calling scipy.optimize.anneal.</p>
<p>We give a brief description of how the three temperature schedules
generate new points and vary their temperature. Temperatures are
only updated with iterations in the outer loop. The inner loop is
over loop over xrange(dwell), and new points are generated for
every iteration in the inner loop. (Though whether the proposed
new points are accepted is probabilistic.)</p>
<p>For readability, let d denote the dimension of the inputs to func.
Also, let x_old denote the previous state, and k denote the
iteration number of the outer loop. All other variables not
defined below are input variables to scipy.optimize.anneal itself.</p>
<p>In the ‘fast’ schedule the updates are</p>
<div class="highlight-python"><pre>u ~ Uniform(0, 1, size=d)
y = sgn(u - 0.5) * T * ((1+ 1/T)**abs(2u-1) -1.0)
xc = y * (upper - lower)
x_new = x_old + xc

c = n * exp(-n * quench)
T_new = T0 * exp(-c * k**quench)</pre>
</div>
<p>In the ‘cauchy’ schedule the updates are</p>
<div class="highlight-python"><pre>u ~ Uniform(-pi/2, pi/2, size=d)
xc = learn_rate * T * tan(u)
x_new = x_old + xc

T_new = T0 / (1+k)</pre>
</div>
<p>In the ‘boltzmann’ schedule the updates are</p>
<div class="highlight-python"><pre>std = minimum( sqrt(T) * ones(d), (upper-lower) / (3*learn_rate) )
y ~ Normal(0, std, size=d)
x_new = x_old + learn_rate * y

T_new = T0 / log(1+k)</pre>
</div>
</dd></dl>
</div>
</div>
</div>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<p class="logo"><a href="../index.html">
<img alt="Logo" class="logo" src="../_static/scipyshiny_small.png"/>
</a></p>
<h4>Previous topic</h4>
<p class="topless"><a href="scipy.optimize.nnls.html" title="previous chapter">scipy.optimize.nnls</a></p>
<h4>Next topic</h4>
<p class="topless"><a href="scipy.optimize.basinhopping.html" title="next chapter">scipy.optimize.basinhopping</a></p>
<div id="searchbox" style="display: none">
<h3>Quick search</h3>
<form action="../search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="../np-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="scipy.optimize.basinhopping.html" title="scipy.optimize.basinhopping">next</a> |</li>
<li class="right">
<a href="scipy.optimize.nnls.html" title="scipy.optimize.nnls">previous</a> |</li>
<li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> »</li>
<li><a href="../optimize.html">Optimization and root finding (<tt class="docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> »</li>
</ul>
</div>
<div class="footer">
        © Copyright 2008-2009, The Scipy community.
      Last updated on May 01, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
</body></html>