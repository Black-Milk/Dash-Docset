<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><title>scipy.optimize.root — SciPy v0.12 Reference Guide (DRAFT)</title><link href="../_static/scipy.css" rel="stylesheet" type="text/css"/><link href="../_static/pygments.css" rel="stylesheet" type="text/css"/><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.12.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script><script src="../_static/jquery.js" type="text/javascript"></script><script src="../_static/underscore.js" type="text/javascript"></script><script src="../_static/doctools.js" type="text/javascript"></script><link href="../index.html" rel="top" title="SciPy v0.12 Reference Guide (DRAFT)"/><link href="../optimize.html" rel="up" title="Optimization and root finding (scipy.optimize)"/><link href="scipy.optimize.fsolve.html" rel="next" title="scipy.optimize.fsolve"/><link href="scipy.optimize.fixed_point.html" rel="prev" title="scipy.optimize.fixed_point"/></head><body>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="../np-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="scipy.optimize.fsolve.html" title="scipy.optimize.fsolve">next</a> |</li>
<li class="right">
<a accesskey="P" href="scipy.optimize.fixed_point.html" title="scipy.optimize.fixed_point">previous</a> |</li>
<li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> »</li>
<li><a accesskey="U" href="../optimize.html">Optimization and root finding (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> »</li>
</ul>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="scipy-optimize-root">
<h1>scipy.optimize.root<a class="headerlink" href="#scipy-optimize-root" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="scipy.optimize.root"><a name="//apple_ref/cpp/func/scipy.optimize.root"></a>
<tt class="descclassname">scipy.optimize.</tt><tt class="descname">root</tt><big>(</big><em>fun</em>, <em>x0</em>, <em>args=()</em>, <em>method='hybr'</em>, <em>jac=None</em>, <em>tol=None</em>, <em>callback=None</em>, <em>options=None</em><big>)</big><a class="reference external" href="http://github.com/scipy/scipy/blob/v0.12.0/scipy/optimize/_root.py#L22"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#scipy.optimize.root" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a root of a vector function.</p>
<p class="versionadded">
<span class="versionmodified">New in version 0.11.0.</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>fun</strong> : callable</p>
<blockquote>
<div><p>A vector function to find a root of.</p>
</div></blockquote>
<p><strong>x0</strong> : ndarray</p>
<blockquote>
<div><p>Initial guess.</p>
</div></blockquote>
<p><strong>args</strong> : tuple, optional</p>
<blockquote>
<div><p>Extra arguments passed to the objective function and its Jacobian.</p>
</div></blockquote>
<p><strong>method</strong> : str, optional</p>
<blockquote>
<div><p>Type of solver.  Should be one of</p>
<blockquote>
<div><ul class="simple">
<li>‘hybr’</li>
<li>‘lm’</li>
<li>‘broyden1’</li>
<li>‘broyden2’</li>
<li>‘anderson’</li>
<li>‘linearmixing’</li>
<li>‘diagbroyden’</li>
<li>‘excitingmixing’</li>
<li>‘krylov’</li>
</ul>
</div></blockquote>
</div></blockquote>
<p><strong>jac</strong> : bool or callable, optional</p>
<blockquote>
<div><p>If <em class="xref py py-obj">jac</em> is a Boolean and is True, <em class="xref py py-obj">fun</em> is assumed to return the
value of Jacobian along with the objective function. If False, the
Jacobian will be estimated numerically.
<em class="xref py py-obj">jac</em> can also be a callable returning the Jacobian of <em class="xref py py-obj">fun</em>. In
this case, it must accept the same arguments as <em class="xref py py-obj">fun</em>.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Tolerance for termination. For detailed control, use solver-specific
options.</p>
</div></blockquote>
<p><strong>callback</strong> : function, optional</p>
<blockquote>
<div><p>Optional callback function. It is called on every iteration as
<tt class="docutils literal"><span class="pre">callback(x,</span> <span class="pre">f)</span></tt> where <em class="xref py py-obj">x</em> is the current solution and <em class="xref py py-obj">f</em>
the corresponding residual. For all methods but ‘hybr’ and ‘lm’.</p>
</div></blockquote>
<p><strong>options</strong> : dict, optional</p>
<blockquote>
<div><p>A dictionary of solver options. E.g. <em class="xref py py-obj">xtol</em> or <em class="xref py py-obj">maxiter</em>, see
<tt class="docutils literal"><span class="pre">show_options('root',</span> <span class="pre">method)</span></tt> for details.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>sol</strong> : Result</p>
<blockquote class="last">
<div><p>The solution represented as a <tt class="docutils literal"><span class="pre">Result</span></tt> object.
Important attributes are: <tt class="docutils literal"><span class="pre">x</span></tt> the solution array, <tt class="docutils literal"><span class="pre">success</span></tt> a
Boolean flag indicating if the algorithm exited successfully and
<tt class="docutils literal"><span class="pre">message</span></tt> which describes the cause of the termination. See
<tt class="xref py py-obj docutils literal"><span class="pre">Result</span></tt> for a description of other attributes.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This section describes the available solvers that can be selected by the
‘method’ parameter. The default method is <em>hybr</em>.</p>
<p>Method <em>hybr</em> uses a modification of the Powell hybrid method as
implemented in MINPACK <a class="reference internal" href="#r88">[R88]</a>.</p>
<p>Method <em>lm</em> solves the system of nonlinear equations in a least squares
sense using a modification of the Levenberg-Marquardt algorithm as
implemented in MINPACK <a class="reference internal" href="#r88">[R88]</a>.</p>
<p>Methods <em>broyden1</em>, <em>broyden2</em>, <em>anderson</em>, <em>linearmixing</em>,
<em>diagbroyden</em>, <em>excitingmixing</em>, <em>krylov</em> are inexact Newton methods,
with backtracking or full line searches <a class="reference internal" href="#r89">[R89]</a>. Each method corresponds
to a particular Jacobian approximations. See <a class="reference internal" href="../optimize.nonlin.html#module-scipy.optimize.nonlin" title="scipy.optimize.nonlin"><tt class="xref py py-obj docutils literal"><span class="pre">nonlin</span></tt></a> for details.</p>
<ul class="simple">
<li>Method <em>broyden1</em> uses Broyden’s first Jacobian approximation, it is
known as Broyden’s good method.</li>
<li>Method <em>broyden2</em> uses Broyden’s second Jacobian approximation, it
is known as Broyden’s bad method.</li>
<li>Method <em>anderson</em> uses (extended) Anderson mixing.</li>
<li>Method <em>Krylov</em> uses Krylov approximation for inverse Jacobian. It
is suitable for large-scale problem.</li>
<li>Method <em>diagbroyden</em> uses diagonal Broyden Jacobian approximation.</li>
<li>Method <em>linearmixing</em> uses a scalar Jacobian approximation.</li>
<li>Method <em>excitingmixing</em> uses a tuned diagonal Jacobian
approximation.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The algorithms implemented for methods <em>diagbroyden</em>,
<em>linearmixing</em> and <em>excitingmixing</em> may be useful for specific
problems, but whether they will work may depend strongly on the
problem.</p>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r88" rules="none">
<colgroup><col class="label"></col><col></col></colgroup>
<tbody valign="top">
<tr><td class="label">[R88]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id4">3</a>)</em> More, Jorge J., Burton S. Garbow, and Kenneth E. Hillstrom.
1980. User Guide for MINPACK-1.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r89" rules="none">
<colgroup><col class="label"></col><col></col></colgroup>
<tbody valign="top">
<tr><td class="label">[R89]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id5">2</a>)</em> C. T. Kelley. 1995. Iterative Methods for Linear and Nonlinear
Equations. Society for Industrial and Applied Mathematics.
&lt;<a class="reference external" href="http://www.siam.org/books/kelley/">http://www.siam.org/books/kelley/</a>&gt;</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>The following functions define a system of nonlinear equations and its
jacobian.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>            <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">jac</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>                     <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<p>A solution can be obtained as follows.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">root</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">'hybr'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol</span><span class="o">.</span><span class="n">x</span>
<span class="go">array([ 0.8411639,  0.1588361])</span>
</pre></div>
</div>
</dd></dl>
</div>
</div>
</div>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<p class="logo"><a href="../index.html">
<img alt="Logo" class="logo" src="../_static/scipyshiny_small.png"/>
</a></p>
<h4>Previous topic</h4>
<p class="topless"><a href="scipy.optimize.fixed_point.html" title="previous chapter">scipy.optimize.fixed_point</a></p>
<h4>Next topic</h4>
<p class="topless"><a href="scipy.optimize.fsolve.html" title="next chapter">scipy.optimize.fsolve</a></p>
<div id="searchbox" style="display: none">
<h3>Quick search</h3>
<form action="../search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="../np-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a href="scipy.optimize.fsolve.html" title="scipy.optimize.fsolve">next</a> |</li>
<li class="right">
<a href="scipy.optimize.fixed_point.html" title="scipy.optimize.fixed_point">previous</a> |</li>
<li><a href="../index.html">SciPy v0.12 Reference Guide (DRAFT)</a> »</li>
<li><a href="../optimize.html">Optimization and root finding (<tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">scipy.optimize</span></tt>)</a> »</li>
</ul>
</div>
<div class="footer">
        © Copyright 2008-2009, The Scipy community.
      Last updated on May 01, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
</body></html>