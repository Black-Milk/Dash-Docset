
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
  
    <title>5. Dataset loading utilities &mdash; scikit-learn 0.14.1 documentation</title>
  <!-- htmltitle is before nature.css - we use this hack to load bootstrap first -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../_static/css/bootstrap.min.css" media="screen" />
  <link rel="stylesheet" href="../_static/css/bootstrap-responsive.css"/>

    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.14.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="scikit-learn 0.14.1 documentation" href="../index.html" />
    <link rel="next" title="Forest covertypes" href="covtype.html" />
    <link rel="prev" title="Documentation of scikit-learn 0.15" href="../documentation.html" />
  
   
       <script type="text/javascript" src="../_static/sidebar.js"></script>
   
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="../_static/js/bootstrap.min.js" type="text/javascript"></script>
  <link rel="canonical" href="http://scikit-learn.org/stable/datasets/index.html" />

  <script type="text/javascript">
    $("div.buttonNext, div.buttonPrevious").hover(
       function () {
           $(this).css('background-color', '#FF9C34');
       },
       function () {
           $(this).css('background-color', '#A7D6E2');
       }
    );
    var bodywrapper = $('.bodywrapper');
    var sidebarbutton = $('#sidebarbutton');
    sidebarbutton.css({'height': '900px'});
  </script>

  </head>
  <body>

<div class="header-wrapper">
    <div class="header">
        <p class="logo"><a href="../index.html">
            <img src="../_static/scikit-learn-logo-small.png" alt="Logo"/>
        </a>
        </p><div class="navbar">
            <ul>
                <li><a href="../../stable/index.html">Home</a></li>
                <li><a href="../../stable/install.html">Installation</a></li>
                <li class="btn-li"><div class="btn-group">
		      <a href="../documentation.html">Documentation</a>
		      <a class="btn dropdown-toggle" data-toggle="dropdown">
			     <span class="caret"></span>
		      </a>
		      <ul class="dropdown-menu">
			<li class="link-title">Scikit-learn 0.14 (stable)</li>
			<li><a href="../tutorial/index.html">Tutorials</a></li>
			<li><a href="../user_guide.html">User guide</a></li>
			<li><a href="../modules/classes.html">API</a></li>
			<li class="divider"></li>
		        <li><a href="http://scikit-learn.org/dev/documentation.html">Development</a></li>
		        <li><a href="http://scikit-learn.org/0.13/">Scikit-learn 0.13</a></li>
		        <li><a href="http://scikit-learn.org/0.12/">Scikit-learn 0.12</a></li>
		        <li><a href="http://scikit-learn.org/0.11/">Scikit-learn 0.11</a></li>
		        <li><a href="../documentation.html">More versions...</a></li>
		      </ul>
		    </div>
		</li>
            <li><a href="../auto_examples/index.html">Examples</a></li>
            </ul>

            <div class="search_form">
                <div id="cse" style="width: 100%;"></div>
            </div>
        </div> <!-- end navbar --></div>
</div>


<!-- Github "fork me" ribbon -->
<a href="https://github.com/scikit-learn/scikit-learn">
  <img class="fork-me"
       style="position: absolute; top: 0; right: 0; border: 0;"
       src="../_static/img/forkme.png"
       alt="Fork me on GitHub" />
</a>

<div class="content-wrapper">
    <div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
        <div class="rel rellarge">
    

  <!-- rellinks[1:] is an ugly hack to avoid link to module
  index -->
        <div class="rellink">
        <a href="../documentation.html"
        accesskey="P">Previous
        <br/>
        <span class="smallrellink">
        Documentation of...
        </span>
            <span class="hiddenrellink">
            Documentation of scikit-learn 0.15
            </span>
        </a>
        </div>
            <div class="spacer">
            &nbsp;
            </div>
        <div class="rellink">
        <a href="covtype.html"
        accesskey="N">Next
        <br/>
        <span class="smallrellink">
        Forest covertype...
        </span>
            <span class="hiddenrellink">
            Forest covertypes
            </span>
        </a>
        </div>
            <div class="spacer">
            &nbsp;
            </div>
        <div class="rellink">
        <a href="../np-modindex.html"
        >Modules
        <br/>
        <span class="smallrellink">
        Python Module In...
        </span>
            <span class="hiddenrellink">
            Python Module Index
            </span>
        </a>
        </div>
            <div class="spacer">
            &nbsp;
            </div>
        <div class="rellink">
        <a href="../py-modindex.html"
        >Modules
        <br/>
        <span class="smallrellink">
        Python Module In...
        </span>
            <span class="hiddenrellink">
            Python Module Index
            </span>
        </a>
        </div>

    <!-- Ad a link to the 'up' page -->
    </div>
    
      <p class="doc-version">This documentation is for scikit-learn <strong>version 0.14.1</strong> &mdash; <a href="http://scikit-learn.org/stable/support.html#documentation-resources">Other versions</a></p>
    <p class="citing">If you use the software, please consider <a href="../about.html#citing-scikit-learn">citing scikit-learn</a>.</p>
    <ul>
<li><a class="reference internal" href="#">5. Dataset loading utilities</a><ul>
<li><a class="reference internal" href="#general-dataset-api">5.1. General dataset API</a></li>
<li><a class="reference internal" href="#toy-datasets">5.2. Toy datasets</a></li>
<li><a class="reference internal" href="#sample-images">5.3. Sample images</a></li>
<li><a class="reference internal" href="#sample-generators">5.4. Sample generators</a></li>
<li><a class="reference internal" href="#datasets-in-svmlight-libsvm-format">5.5. Datasets in svmlight / libsvm format</a></li>
<li><a class="reference internal" href="#the-olivetti-faces-dataset">5.6. The Olivetti faces dataset</a></li>
<li><a class="reference internal" href="#the-20-newsgroups-text-dataset">5.7. The 20 newsgroups text dataset</a><ul>
<li><a class="reference internal" href="#usage">5.7.1. Usage</a></li>
<li><a class="reference internal" href="#converting-text-to-vectors">5.7.2. Converting text to vectors</a></li>
<li><a class="reference internal" href="#filtering-text-for-more-realistic-training">5.7.3. Filtering text for more realistic training</a></li>
</ul>
</li>
<li><a class="reference internal" href="#downloading-datasets-from-the-mldata-org-repository">5.8. Downloading datasets from the mldata.org repository</a></li>
<li><a class="reference internal" href="#the-labeled-faces-in-the-wild-face-recognition-dataset">5.9. The Labeled Faces in the Wild face recognition dataset</a><ul>
<li><a class="reference internal" href="#id6">5.9.1. Usage</a></li>
<li><a class="reference internal" href="#examples">5.9.2. Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#forest-covertypes">5.10. Forest covertypes</a></li>
</ul>
</li>
</ul>

    </div>
</div>



      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="dataset-loading-utilities">
<span id="datasets"></span><h1>5. Dataset loading utilities<a class="headerlink" href="#dataset-loading-utilities" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">sklearn.datasets</span></tt> package embeds some small toy datasets
as introduced in the <a class="reference internal" href="../tutorial/basic/tutorial.html#loading-example-dataset"><em>Getting Started</em></a> section.</p>
<p>To evaluate the impact of the scale of the dataset (<tt class="docutils literal"><span class="pre">n_samples</span></tt> and
<tt class="docutils literal"><span class="pre">n_features</span></tt>) while controlling the statistical properties of the data
(typically the correlation and informativeness of the features), it is
also possible to generate synthetic data.</p>
<p>This package also features helpers to fetch larger datasets commonly
used by the machine learning community to benchmark algorithm on data
that comes from the &#8216;real world&#8217;.</p>
<div class="section" id="general-dataset-api">
<h2>5.1. General dataset API<a class="headerlink" href="#general-dataset-api" title="Permalink to this headline">¶</a></h2>
<p>There are three distinct kinds of dataset interfaces for different types
of datasets.
The simplest one is the interface for sample images, which is described
below in the <a class="reference internal" href="#sample-images"><em>Sample images</em></a> section.</p>
<p>The dataset generation functions and the svmlight loader share a simplistic
interface, returning a tuple <tt class="docutils literal"><span class="pre">(X,</span> <span class="pre">y)</span></tt> consisting of a n_samples x n_features
numpy array X and an array of length n_samples containing the targets y.</p>
<p>The toy datasets as well as the &#8216;real world&#8217; datasets and the datasets
fetched from mldata.org have more sophisticated structure.
These functions return a dictionary-like object holding at least two items:
an array of shape <tt class="docutils literal"><span class="pre">n_samples</span></tt> * `` n_features`` with key <tt class="docutils literal"><span class="pre">data</span></tt>
(except for 20newsgroups)
and a NumPy array of length <tt class="docutils literal"><span class="pre">n_samples</span></tt>, containing the target values,
with key <tt class="docutils literal"><span class="pre">target</span></tt>.</p>
<p>The datasets also contain a description in <tt class="docutils literal"><span class="pre">DESCR</span></tt> and some contain
<tt class="docutils literal"><span class="pre">feature_names</span></tt> and <tt class="docutils literal"><span class="pre">target_names</span></tt>.
See the dataset descriptions below for details.</p>
</div>
<div class="section" id="toy-datasets">
<h2>5.2. Toy datasets<a class="headerlink" href="#toy-datasets" title="Permalink to this headline">¶</a></h2>
<p>scikit-learn comes with a few small standard datasets that do not
require to download any file from some external website.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston" title="sklearn.datasets.load_boston"><tt class="xref py py-obj docutils literal"><span class="pre">load_boston</span></tt></a>()</td>
<td>Load and return the boston house-prices dataset (regression).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_iris.html#sklearn.datasets.load_iris" title="sklearn.datasets.load_iris"><tt class="xref py py-obj docutils literal"><span class="pre">load_iris</span></tt></a>()</td>
<td>Load and return the iris dataset (classification).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_diabetes.html#sklearn.datasets.load_diabetes" title="sklearn.datasets.load_diabetes"><tt class="xref py py-obj docutils literal"><span class="pre">load_diabetes</span></tt></a>()</td>
<td>Load and return the diabetes dataset (regression).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_digits.html#sklearn.datasets.load_digits" title="sklearn.datasets.load_digits"><tt class="xref py py-obj docutils literal"><span class="pre">load_digits</span></tt></a>([n_class])</td>
<td>Load and return the digits dataset (classification).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_linnerud.html#sklearn.datasets.load_linnerud" title="sklearn.datasets.load_linnerud"><tt class="xref py py-obj docutils literal"><span class="pre">load_linnerud</span></tt></a>()</td>
<td>Load and return the linnerud dataset (multivariate regression).</td>
</tr>
</tbody>
</table>
<p>These datasets are useful to quickly illustrate the behavior of the
various algorithms implemented in the scikit. They are however often too
small to be representative of real world machine learning tasks.</p>
</div>
<div class="section" id="sample-images">
<span id="id1"></span><h2>5.3. Sample images<a class="headerlink" href="#sample-images" title="Permalink to this headline">¶</a></h2>
<p>The scikit also embed a couple of sample JPEG images published under Creative
Commons license by their authors. Those image can be useful to test algorithms
and pipeline on 2D data.</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_sample_images.html#sklearn.datasets.load_sample_images" title="sklearn.datasets.load_sample_images"><tt class="xref py py-obj docutils literal"><span class="pre">load_sample_images</span></tt></a>()</td>
<td>Load sample images for image manipulation.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.load_sample_image.html#sklearn.datasets.load_sample_image" title="sklearn.datasets.load_sample_image"><tt class="xref py py-obj docutils literal"><span class="pre">load_sample_image</span></tt></a>(image_name)</td>
<td>Load the numpy array of a single sample image   :Parameters:      <strong>image_name: {`china.jpg`, `flower.jpg`}</strong> :           The name of the sample image loaded  :Returns:      <strong>img: 3D array</strong> :           The image as a numpy array: height x width x color  ..</td>
</tr>
</tbody>
</table>
<a class="reference external image-reference" href="../auto_examples/cluster/plot_color_quantization.html"><img alt="datasets/../auto_examples/cluster/images/plot_color_quantization_1.png" class="align-right" src="datasets/../auto_examples/cluster/images/plot_color_quantization_1.png" /></a>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The default coding of images is based on the <tt class="docutils literal"><span class="pre">uint8</span></tt> dtype to
spare memory.  Often machine learning algorithms work best if the
input is converted to a floating point representation first.  Also,
if you plan to use <tt class="docutils literal"><span class="pre">pylab.imshow</span></tt> don&#8217;t forget to scale to the range
0 - 1 as done in the following example.</p>
</div>
<div class="topic">
<p class="topic-title first">Examples:</p>
<ul class="simple">
<li><a class="reference internal" href="../auto_examples/cluster/plot_color_quantization.html#example-cluster-plot-color-quantization-py"><em>Color Quantization using K-Means</em></a></li>
</ul>
</div>
</div>
<div class="section" id="sample-generators">
<span id="id2"></span><h2>5.4. Sample generators<a class="headerlink" href="#sample-generators" title="Permalink to this headline">¶</a></h2>
<p>In addition, scikit-learn includes various random sample generators that
can be used to build artificial datasets of controlled size and complexity.</p>
<a class="reference external image-reference" href="../auto_examples/datasets/plot_random_dataset.html"><img alt="../_images/plot_random_dataset_11.png" class="align-center" src="../_images/plot_random_dataset_11.png" style="width: 400.0px; height: 300.0px;" /></a>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_classification.html#sklearn.datasets.make_classification" title="sklearn.datasets.make_classification"><tt class="xref py py-obj docutils literal"><span class="pre">make_classification</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;...])</td>
<td>Generate a random n-class classification problem.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_multilabel_classification.html#sklearn.datasets.make_multilabel_classification" title="sklearn.datasets.make_multilabel_classification"><tt class="xref py py-obj docutils literal"><span class="pre">make_multilabel_classification</span></tt></a>([n_samples,&nbsp;...])</td>
<td>Generate a random multilabel classification problem.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_regression.html#sklearn.datasets.make_regression" title="sklearn.datasets.make_regression"><tt class="xref py py-obj docutils literal"><span class="pre">make_regression</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;...])</td>
<td>Generate a random regression problem.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_blobs.html#sklearn.datasets.make_blobs" title="sklearn.datasets.make_blobs"><tt class="xref py py-obj docutils literal"><span class="pre">make_blobs</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;centers,&nbsp;...])</td>
<td>Generate isotropic Gaussian blobs for clustering.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_friedman1.html#sklearn.datasets.make_friedman1" title="sklearn.datasets.make_friedman1"><tt class="xref py py-obj docutils literal"><span class="pre">make_friedman1</span></tt></a>([n_samples,&nbsp;n_features,&nbsp;...])</td>
<td>Generate the &#8220;Friedman #1&#8221; regression problem  This dataset is described in Friedman [1] and Breiman [2].</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_friedman2.html#sklearn.datasets.make_friedman2" title="sklearn.datasets.make_friedman2"><tt class="xref py py-obj docutils literal"><span class="pre">make_friedman2</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate the &#8220;Friedman #2&#8221; regression problem  This dataset is described in Friedman [1] and Breiman [2].</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_friedman3.html#sklearn.datasets.make_friedman3" title="sklearn.datasets.make_friedman3"><tt class="xref py py-obj docutils literal"><span class="pre">make_friedman3</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate the &#8220;Friedman #3&#8221; regression problem  This dataset is described in Friedman [1] and Breiman [2].</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_hastie_10_2.html#sklearn.datasets.make_hastie_10_2" title="sklearn.datasets.make_hastie_10_2"><tt class="xref py py-obj docutils literal"><span class="pre">make_hastie_10_2</span></tt></a>([n_samples,&nbsp;random_state])</td>
<td>Generates data for binary classification used in Hastie et al.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_low_rank_matrix.html#sklearn.datasets.make_low_rank_matrix" title="sklearn.datasets.make_low_rank_matrix"><tt class="xref py py-obj docutils literal"><span class="pre">make_low_rank_matrix</span></tt></a>([n_samples,&nbsp;...])</td>
<td>Generate a mostly low rank matrix with bell-shaped singular values  Most of the variance can be explained by a bell-shaped curve of width effective_rank: the low rank part of the singular values profile is::      (1 - tail_strength) * exp(-1.0 * (i / effective_rank) ** 2)  The remaining singular values&#8217; tail is fat, decreasing as::      tail_strength * exp(-0.1 * i / effective_rank).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_sparse_coded_signal.html#sklearn.datasets.make_sparse_coded_signal" title="sklearn.datasets.make_sparse_coded_signal"><tt class="xref py py-obj docutils literal"><span class="pre">make_sparse_coded_signal</span></tt></a>(n_samples,&nbsp;...[,&nbsp;...])</td>
<td>Generate a signal as a sparse combination of dictionary elements.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_sparse_uncorrelated.html#sklearn.datasets.make_sparse_uncorrelated" title="sklearn.datasets.make_sparse_uncorrelated"><tt class="xref py py-obj docutils literal"><span class="pre">make_sparse_uncorrelated</span></tt></a>([n_samples,&nbsp;...])</td>
<td>Generate a random regression problem with sparse uncorrelated design  This dataset is described in Celeux et al [1].</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_spd_matrix.html#sklearn.datasets.make_spd_matrix" title="sklearn.datasets.make_spd_matrix"><tt class="xref py py-obj docutils literal"><span class="pre">make_spd_matrix</span></tt></a>(n_dim[,&nbsp;random_state])</td>
<td>Generate a random symmetric, positive-definite matrix.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_swiss_roll.html#sklearn.datasets.make_swiss_roll" title="sklearn.datasets.make_swiss_roll"><tt class="xref py py-obj docutils literal"><span class="pre">make_swiss_roll</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate a swiss roll dataset.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_s_curve.html#sklearn.datasets.make_s_curve" title="sklearn.datasets.make_s_curve"><tt class="xref py py-obj docutils literal"><span class="pre">make_s_curve</span></tt></a>([n_samples,&nbsp;noise,&nbsp;random_state])</td>
<td>Generate an S curve dataset.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_sparse_spd_matrix.html#sklearn.datasets.make_sparse_spd_matrix" title="sklearn.datasets.make_sparse_spd_matrix"><tt class="xref py py-obj docutils literal"><span class="pre">make_sparse_spd_matrix</span></tt></a>([dim,&nbsp;alpha,&nbsp;...])</td>
<td>Generate a sparse symmetric definite positive matrix.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_biclusters.html#sklearn.datasets.make_biclusters" title="sklearn.datasets.make_biclusters"><tt class="xref py py-obj docutils literal"><span class="pre">make_biclusters</span></tt></a>(shape,&nbsp;n_clusters[,&nbsp;noise,&nbsp;...])</td>
<td>Generate an array with constant block diagonal structure for biclustering.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../modules/generated/sklearn.datasets.make_checkerboard.html#sklearn.datasets.make_checkerboard" title="sklearn.datasets.make_checkerboard"><tt class="xref py py-obj docutils literal"><span class="pre">make_checkerboard</span></tt></a>(shape,&nbsp;n_clusters[,&nbsp;...])</td>
<td>Generate an array with block checkerboard structure for biclustering.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="datasets-in-svmlight-libsvm-format">
<span id="libsvm-loader"></span><h2>5.5. Datasets in svmlight / libsvm format<a class="headerlink" href="#datasets-in-svmlight-libsvm-format" title="Permalink to this headline">¶</a></h2>
<p>scikit-learn includes utility functions for loading
datasets in the svmlight / libsvm format. In this format, each line
takes the form <tt class="docutils literal"><span class="pre">&lt;label&gt;</span> <span class="pre">&lt;feature-id&gt;:&lt;feature-value&gt;</span>
<span class="pre">&lt;feature-id&gt;:&lt;feature-value&gt;</span> <span class="pre">...</span></tt>. This format is especially suitable for sparse datasets.
In this module, scipy sparse CSR matrices are used for <tt class="docutils literal"><span class="pre">X</span></tt> and numpy arrays are used for <tt class="docutils literal"><span class="pre">y</span></tt>.</p>
<p>You may load a dataset like as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_svmlight_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">load_svmlight_file</span><span class="p">(</span><span class="s">&quot;/path/to/train_dataset.txt&quot;</span><span class="p">)</span>
<span class="gp">... </span>                                                        
</pre></div>
</div>
<p>You may also load two (or more) datasets at once:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">load_svmlight_files</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="s">&quot;/path/to/train_dataset.txt&quot;</span><span class="p">,</span> <span class="s">&quot;/path/to/test_dataset.txt&quot;</span><span class="p">))</span>
<span class="gp">... </span>                                                        
</pre></div>
</div>
<p>In this case, <tt class="docutils literal"><span class="pre">X_train</span></tt> and <tt class="docutils literal"><span class="pre">X_test</span></tt> are guaranteed to have the same number
of features. Another way to achieve the same result is to fix the number of
features:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">load_svmlight_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="s">&quot;/path/to/test_dataset.txt&quot;</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">... </span>                                                        
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Related links:</p>
<p><span class="target" id="public-datasets-in-svmlight-libsvm-format">Public datasets in svmlight / libsvm format</span>: <a class="reference external" href="http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/">http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/</a></p>
<p><span class="target" id="faster-api-compatible-implementation">Faster API-compatible implementation</span>: <a class="reference external" href="https://github.com/mblondel/svmlight-loader">https://github.com/mblondel/svmlight-loader</a></p>
</div>
</div>
<div class="section" id="the-olivetti-faces-dataset">
<span id="olivetti-faces"></span><h2>5.6. The Olivetti faces dataset<a class="headerlink" href="#the-olivetti-faces-dataset" title="Permalink to this headline">¶</a></h2>
<p>This dataset contains a set of face images taken between April 1992 and April
1994 at AT&amp;T Laboratories Cambridge. The website describing the original
dataset is now defunct, but archived copies can be accessed through
<a class="reference external" href="http://wayback.archive.org/web/*/http://www.uk.research.att.com/facedatabase.html">the Internet Archive&#8217;s Wayback Machine</a>.</p>
<p>As described on the original website:</p>
<blockquote>
<div>There are ten different images of each of 40 distinct subjects. For some
subjects, the images were taken at different times, varying the lighting,
facial expressions (open / closed eyes, smiling / not smiling) and facial
details (glasses / no glasses). All the images were taken against a dark
homogeneous background with the subjects in an upright, frontal position (with
tolerance for some side movement).</div></blockquote>
<p>The image is quantized to 256 grey levels and stored as unsigned 8-bit integers;
the loader will convert these to floating point values on the interval [0, 1],
which are easier to work with for many algorithms.</p>
<p>The &#8220;target&#8221; for this database is an integer from 0 to 39 indicating the
identity of the person pictured; however, with only 10 examples per class, this
relatively small dataset is more interesting from an unsupervised or
semi-supervised perspective.</p>
<p>The original dataset consisted of 92 x 112, while the version available here
consists of 64x64 images.</p>
<p>When using these images, please give credit to AT&amp;T Laboratories Cambridge.</p>
</div>
<div class="section" id="the-20-newsgroups-text-dataset">
<span id="newsgroups"></span><h2>5.7. The 20 newsgroups text dataset<a class="headerlink" href="#the-20-newsgroups-text-dataset" title="Permalink to this headline">¶</a></h2>
<p>The 20 newsgroups dataset comprises around 18000 newsgroups posts on
20 topics split in two subsets: one for training (or development)
and the other one for testing (or for performance evaluation). The split
between the train and test set is based upon a messages posted before
and after a specific date.</p>
<p>This module contains two loaders. The first one,
<tt class="docutils literal"><span class="pre">sklearn.datasets.fetch_20newsgroups</span></tt>,
returns a list of the raw texts that can be fed to text feature
extractors such as <tt class="xref py py-class docutils literal"><span class="pre">sklearn.feature_extraction.text.Vectorizer</span></tt>
with custom parameters so as to extract feature vectors.
The second one, <tt class="docutils literal"><span class="pre">sklearn.datasets.fetch_20newsgroups_vectorized</span></tt>,
returns ready-to-use features, i.e., it is not necessary to use a feature
extractor.</p>
<div class="section" id="usage">
<h3>5.7.1. Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">sklearn.datasets.fetch_20newsgroups</span></tt> function is a data
fetching / caching functions that downloads the data archive from
the original <a class="reference external" href="http://people.csail.mit.edu/jrennie/20Newsgroups/">20 newsgroups website</a>, extracts the archive contents
in the <tt class="docutils literal"><span class="pre">~/scikit_learn_data/20news_home</span></tt> folder and calls the
<tt class="docutils literal"><span class="pre">sklearn.datasets.load_file</span></tt> on either the training or
testing set folder, or both of them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">))</span>
<span class="go">[&#39;alt.atheism&#39;,</span>
<span class="go"> &#39;comp.graphics&#39;,</span>
<span class="go"> &#39;comp.os.ms-windows.misc&#39;,</span>
<span class="go"> &#39;comp.sys.ibm.pc.hardware&#39;,</span>
<span class="go"> &#39;comp.sys.mac.hardware&#39;,</span>
<span class="go"> &#39;comp.windows.x&#39;,</span>
<span class="go"> &#39;misc.forsale&#39;,</span>
<span class="go"> &#39;rec.autos&#39;,</span>
<span class="go"> &#39;rec.motorcycles&#39;,</span>
<span class="go"> &#39;rec.sport.baseball&#39;,</span>
<span class="go"> &#39;rec.sport.hockey&#39;,</span>
<span class="go"> &#39;sci.crypt&#39;,</span>
<span class="go"> &#39;sci.electronics&#39;,</span>
<span class="go"> &#39;sci.med&#39;,</span>
<span class="go"> &#39;sci.space&#39;,</span>
<span class="go"> &#39;soc.religion.christian&#39;,</span>
<span class="go"> &#39;talk.politics.guns&#39;,</span>
<span class="go"> &#39;talk.politics.mideast&#39;,</span>
<span class="go"> &#39;talk.politics.misc&#39;,</span>
<span class="go"> &#39;talk.religion.misc&#39;]</span>
</pre></div>
</div>
<p>The real data lies in the <tt class="docutils literal"><span class="pre">filenames</span></tt> and <tt class="docutils literal"><span class="pre">target</span></tt> attributes. The target
attribute is the integer index of the category:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(11314,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(11314,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">array([12,  6,  9,  8,  6,  7,  9,  2, 13, 19])</span>
</pre></div>
</div>
<p>It is possible to load only a sub-selection of the categories by passing the
list of the categories to load to the <tt class="docutils literal"><span class="pre">fetch_20newsgroups</span></tt> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;alt.atheism&#39;</span><span class="p">,</span> <span class="s">&#39;sci.space&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">cats</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="go">[&#39;alt.atheism&#39;, &#39;sci.space&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">filenames</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1073,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1073,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="go">array([1, 1, 1, 0, 1, 0, 0, 1, 1, 1])</span>
</pre></div>
</div>
</div>
<div class="section" id="converting-text-to-vectors">
<h3>5.7.2. Converting text to vectors<a class="headerlink" href="#converting-text-to-vectors" title="Permalink to this headline">¶</a></h3>
<p>In order to feed predictive or clustering models with the text data,
one first need to turn the text into vectors of numerical values suitable
for statistical analysis. This can be achieved with the utilities of the
<tt class="docutils literal"><span class="pre">sklearn.feature_extraction.text</span></tt> as demonstrated in the following
example that extract <a class="reference external" href="http://en.wikipedia.org/wiki/Tf-idf">TF-IDF</a> vectors of unigram tokens
from a subset of 20news:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">categories</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;alt.atheism&#39;</span><span class="p">,</span> <span class="s">&#39;talk.religion.misc&#39;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="s">&#39;comp.graphics&#39;</span><span class="p">,</span> <span class="s">&#39;sci.space&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2034, 34118)</span>
</pre></div>
</div>
<p>The extracted TF-IDF vectors are very sparse, with an average of 159 non-zero
components by sample in a more than 30000-dimensional space
(less than .5% non-zero features):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span><span class="o">.</span><span class="n">nnz</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">vectors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">159.01327433628319</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">sklearn.datasets.fetch_20newsgroups_vectorized</span></tt> is a function which returns
ready-to-use tfidf features instead of file names.</p>
</div>
<div class="section" id="filtering-text-for-more-realistic-training">
<h3>5.7.3. Filtering text for more realistic training<a class="headerlink" href="#filtering-text-for-more-realistic-training" title="Permalink to this headline">¶</a></h3>
<p>It is easy for a classifier to overfit on particular things that appear in the
20 Newsgroups data, such as newsgroup headers. Many classifiers achieve very
high F-scores, but their results would not generalize to other documents that
aren&#8217;t from this window of time.</p>
<p>For example, let&#8217;s look at the results of a multinomial Naive Bayes classifier,
which is fast to train and achieves a decent F-score:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_test</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                     <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">newsgroups_test</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=.</span><span class="mo">01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectors_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">newsgroups_test</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="go">0.88251152461278892</span>
</pre></div>
</div>
<p>(The example <a class="reference internal" href="../auto_examples/document_classification_20newsgroups.html#example-document-classification-20newsgroups-py"><em>Classification of text documents using sparse features</em></a> shuffles
the training and test data, instead of segmenting by time, and in that case
multinomial Naive Bayes gets a much higher F-score of 0.88. Are you suspicious
yet of what&#8217;s going on inside this classifier?)</p>
<p>Let&#8217;s take a look at what the most informative features are:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">show_top10</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">,</span> <span class="n">categories</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">feature_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vectorizer</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">category</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categories</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">top10</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="gp">... </span>        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">feature_names</span><span class="p">[</span><span class="n">top10</span><span class="p">])))</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">show_top10</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">vectorizer</span><span class="p">,</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="go">alt.atheism: sgi livesey atheists writes people caltech com god keith edu</span>
<span class="go">comp.graphics: organization thanks files subject com image lines university edu graphics</span>
<span class="go">sci.space: toronto moon gov com alaska access henry nasa edu space</span>
<span class="go">talk.religion.misc: article writes kent people christian jesus sandvik edu com god</span>
</pre></div>
</div>
<p>You can now see many things that these features have overfit to:</p>
<ul class="simple">
<li>Almost every group is distinguished by whether headers such as
<tt class="docutils literal"><span class="pre">NNTP-Posting-Host:</span></tt> and <tt class="docutils literal"><span class="pre">Distribution:</span></tt> appear more or less often.</li>
<li>Another significant feature involves whether the sender is affiliated with
a university, as indicated either by their headers or their signature.</li>
<li>The word &#8220;article&#8221; is a significant feature, based on how often people quote
previous posts like this: &#8220;In article [article ID], [name] &lt;[e-mail address]&gt;
wrote:&#8221;</li>
<li>Other features match the names and e-mail addresses of particular people who
were posting at the time.</li>
</ul>
<p>With such an abundance of clues that distinguish newsgroups, the classifiers
barely have to identify topics from text at all, and they all perform at the
same high level.</p>
<p>For this reason, the functions that load 20 Newsgroups data provide a
parameter called <strong>remove</strong>, telling it what kinds of information to strip out
of each file. <strong>remove</strong> should be a tuple containing any subset of
<tt class="docutils literal"><span class="pre">('headers',</span> <span class="pre">'footers',</span> <span class="pre">'quotes')</span></tt>, telling it to remove headers, signature
blocks, and quotation blocks respectively.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_test</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;test&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                     <span class="n">remove</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;headers&#39;</span><span class="p">,</span> <span class="s">&#39;footers&#39;</span><span class="p">,</span> <span class="s">&#39;quotes&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                     <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">newsgroups_test</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectors_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">newsgroups_test</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="go">0.78409163025839435</span>
</pre></div>
</div>
<p>This classifier lost over a lot of its F-score, just because we removed
metadata that has little to do with topic classification.
It loses even more if we also strip this metadata from the training data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">newsgroups_train</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">remove</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;headers&#39;</span><span class="p">,</span> <span class="s">&#39;footers&#39;</span><span class="p">,</span> <span class="s">&#39;quotes&#39;</span><span class="p">),</span>
<span class="gp">... </span>                                      <span class="n">categories</span><span class="o">=</span><span class="n">categories</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">newsgroups_train</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span> <span class="o">=</span> <span class="n">BernoulliNB</span><span class="p">(</span><span class="n">alpha</span><span class="o">=.</span><span class="mo">01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">newsgroups_train</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors_test</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">newsgroups_test</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">vectors_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">newsgroups_test</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>
<span class="go">0.73160869205141166</span>
</pre></div>
</div>
<p>Some other classifiers cope better with this harder version of the task. Try
running <a class="reference internal" href="../auto_examples/grid_search_text_feature_extraction.html#example-grid-search-text-feature-extraction-py"><em>Sample pipeline for text feature extraction and evaluation</em></a> with and without
the <tt class="docutils literal"><span class="pre">--filter</span></tt> option to compare the results.</p>
<div class="topic">
<p class="topic-title first">Recommendation</p>
<p>When evaluating text classifiers on the 20 Newsgroups data, you
should strip newsgroup-related metadata. In scikit-learn, you can do this by
setting <tt class="docutils literal"><span class="pre">remove=('headers',</span> <span class="pre">'footers',</span> <span class="pre">'quotes')</span></tt>. The F-score will be
lower because it is more realistic.</p>
</div>
<div class="topic">
<p class="topic-title first">Examples</p>
<ul class="simple">
<li><a class="reference internal" href="../auto_examples/grid_search_text_feature_extraction.html#example-grid-search-text-feature-extraction-py"><em>Sample pipeline for text feature extraction and evaluation</em></a></li>
<li><a class="reference internal" href="../auto_examples/document_classification_20newsgroups.html#example-document-classification-20newsgroups-py"><em>Classification of text documents using sparse features</em></a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="downloading-datasets-from-the-mldata-org-repository">
<span id="mldata"></span><h2>5.8. Downloading datasets from the mldata.org repository<a class="headerlink" href="#downloading-datasets-from-the-mldata-org-repository" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://mldata.org">mldata.org</a> is a public repository for machine learning
data, supported by the <a class="reference external" href="http://www.pascal-network.org">PASCAL network</a> .</p>
<p>The <tt class="docutils literal"><span class="pre">sklearn.datasets</span></tt> package is able to directly download data
sets from the repository using the function <tt class="docutils literal"><span class="pre">fetch_mldata(dataname)</span></tt>.</p>
<p>For example, to download the MNIST digit recognition database:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_mldata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mnist</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;MNIST original&#39;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
</pre></div>
</div>
<p>The MNIST database contains a total of 70000 examples of handwritten digits
of size 28x28 pixels, labeled from 0 to 9:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mnist</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(70000, 784)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mnist</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(70000,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
<span class="go">array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9.])</span>
</pre></div>
</div>
<p>After the first download, the dataset is cached locally in the path
specified by the <tt class="docutils literal"><span class="pre">data_home</span></tt> keyword argument, which defaults to
<tt class="docutils literal"><span class="pre">~/scikit_learn_data/</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">custom_data_home</span><span class="p">,</span> <span class="s">&#39;mldata&#39;</span><span class="p">))</span>
<span class="go">[&#39;mnist-original.mat&#39;]</span>
</pre></div>
</div>
<p>Data sets in <a class="reference external" href="http://mldata.org">mldata.org</a> do not adhere to a strict
naming or formatting convention. <tt class="docutils literal"><span class="pre">fetch_mldata</span></tt> is able to make sense
of the most common cases, but allows to tailor the defaults to individual
datasets:</p>
<ul>
<li><p class="first">The data arrays in <a class="reference external" href="http://mldata.org">mldata.org</a> are most often
shaped as <tt class="docutils literal"><span class="pre">(n_features,</span> <span class="pre">n_samples)</span></tt>. This is the opposite of the
<tt class="docutils literal"><span class="pre">scikit-learn</span></tt> convention, so <tt class="docutils literal"><span class="pre">fetch_mldata</span></tt> transposes the matrix
by default. The <tt class="docutils literal"><span class="pre">transpose_data</span></tt> keyword controls this behavior:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;iris&#39;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(150, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;iris&#39;</span><span class="p">,</span> <span class="n">transpose_data</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 150)</span>
</pre></div>
</div>
</li>
<li><p class="first">For datasets with multiple columns, <tt class="docutils literal"><span class="pre">fetch_mldata</span></tt> tries to identify
the target and data columns and rename them to <tt class="docutils literal"><span class="pre">target</span></tt> and <tt class="docutils literal"><span class="pre">data</span></tt>.
This is done by looking for arrays named <tt class="docutils literal"><span class="pre">label</span></tt> and <tt class="docutils literal"><span class="pre">data</span></tt> in the
dataset, and failing that by choosing the first array to be <tt class="docutils literal"><span class="pre">target</span></tt>
and the second to be <tt class="docutils literal"><span class="pre">data</span></tt>. This behavior can be changed with the
<tt class="docutils literal"><span class="pre">target_name</span></tt> and <tt class="docutils literal"><span class="pre">data_name</span></tt> keywords, setting them to a specific
name or index number (the name and order of the columns in the datasets
can be found at its <a class="reference external" href="http://mldata.org">mldata.org</a> under the tab &#8220;Data&#8221;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">iris2</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;datasets-UCI iris&#39;</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_name</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iris3</span> <span class="o">=</span> <span class="n">fetch_mldata</span><span class="p">(</span><span class="s">&#39;datasets-UCI iris&#39;</span><span class="p">,</span> <span class="n">target_name</span><span class="o">=</span><span class="s">&#39;class&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">data_name</span><span class="o">=</span><span class="s">&#39;double0&#39;</span><span class="p">,</span> <span class="n">data_home</span><span class="o">=</span><span class="n">custom_data_home</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="the-labeled-faces-in-the-wild-face-recognition-dataset">
<span id="labeled-faces-in-the-wild"></span><h2>5.9. The Labeled Faces in the Wild face recognition dataset<a class="headerlink" href="#the-labeled-faces-in-the-wild-face-recognition-dataset" title="Permalink to this headline">¶</a></h2>
<p>This dataset is a collection of JPEG pictures of famous people collected
over the internet, all details are available on the official website:</p>
<blockquote>
<div><a class="reference external" href="http://vis-www.cs.umass.edu/lfw/">http://vis-www.cs.umass.edu/lfw/</a></div></blockquote>
<p>Each picture is centered on a single face. The typical task is called
Face Verification: given a pair of two pictures, a binary classifier
must predict whether the two images are from the same person.</p>
<p>An alternative task, Face Recognition or Face Identification is:
given the picture of the face of an unknown person, identify the name
of the person by referring to a gallery of previously seen pictures of
identified persons.</p>
<p>Both Face Verification and Face Recognition are tasks that are typically
performed on the output of a model trained to perform Face Detection. The
most popular model for Face Detection is called Viola-Jones and is
implemented in the OpenCV library. The LFW faces were extracted by this
face detector from various online websites.</p>
<div class="section" id="id6">
<h3>5.9.1. Usage<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">scikit-learn</span></tt> provides two loaders that will automatically download,
cache, parse the metadata files, decode the jpeg and convert the
interesting slices into memmaped numpy arrays. This dataset size is more
than 200 MB. The first load typically takes more than a couple of minutes
to fully decode the relevant part of the JPEG files into numpy arrays. If
the dataset has  been loaded once, the following times the loading times
less than 200ms by using a memmaped version memoized on the disk in the
<tt class="docutils literal"><span class="pre">~/scikit_learn_data/lfw_home/</span></tt> folder using <tt class="docutils literal"><span class="pre">joblib</span></tt>.</p>
<p>The first loader is used for the Face Identification task: a multi-class
classification task (hence supervised learning):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_lfw_people</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span> <span class="o">=</span> <span class="n">fetch_lfw_people</span><span class="p">(</span><span class="n">min_faces_per_person</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">resize</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">lfw_people</span><span class="o">.</span><span class="n">target_names</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">Ariel Sharon</span>
<span class="go">Colin Powell</span>
<span class="go">Donald Rumsfeld</span>
<span class="go">George W Bush</span>
<span class="go">Gerhard Schroeder</span>
<span class="go">Hugo Chavez</span>
<span class="go">Tony Blair</span>
</pre></div>
</div>
<p>The default slice is a rectangular shape around the face, removing
most of the background:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">dtype(&#39;float32&#39;)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1288, 1850)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1288, 50, 37)</span>
</pre></div>
</div>
<p>Each of the <tt class="docutils literal"><span class="pre">1140</span></tt> faces is assigned to a single person id in the <tt class="docutils literal"><span class="pre">target</span></tt>
array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_people</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(1288,)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">lfw_people</span><span class="o">.</span><span class="n">target</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>
<span class="go">[5, 6, 3, 1, 0, 1, 3, 4, 3, 0]</span>
</pre></div>
</div>
<p>The second loader is typically used for the face verification task: each sample
is a pair of two picture belonging or not to the same person:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_lfw_pairs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span> <span class="o">=</span> <span class="n">fetch_lfw_pairs</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s">&#39;train&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="go">[&#39;Different persons&#39;, &#39;Same person&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">pairs</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2200, 2, 62, 47)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2200, 5828)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lfw_pairs_train</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(2200,)</span>
</pre></div>
</div>
<p>Both for the <tt class="docutils literal"><span class="pre">fetch_lfw_people</span></tt> and <tt class="docutils literal"><span class="pre">fetch_lfw_pairs</span></tt> function it is
possible to get an additional dimension with the RGB color channels by
passing <tt class="docutils literal"><span class="pre">color=True</span></tt>, in that case the shape will be
<tt class="docutils literal"><span class="pre">(2200,</span> <span class="pre">2,</span> <span class="pre">62,</span> <span class="pre">47,</span> <span class="pre">3)</span></tt>.</p>
<p>The <tt class="docutils literal"><span class="pre">fetch_lfw_pairs</span></tt> datasets is subdivided into 3 subsets: the development
<tt class="docutils literal"><span class="pre">train</span></tt> set, the development <tt class="docutils literal"><span class="pre">test</span></tt> set and an evaluation <tt class="docutils literal"><span class="pre">10_folds</span></tt>
set meant to compute performance metrics using a 10-folds cross
validation scheme.</p>
<div class="topic">
<p class="topic-title first">References:</p>
<ul class="simple">
<li><a class="reference external" href="http://vis-www.cs.umass.edu/lfw/lfw.pdf">Labeled Faces in the Wild: A Database for Studying Face Recognition
in Unconstrained Environments.</a>
Gary B. Huang, Manu Ramesh, Tamara Berg, and Erik Learned-Miller.
University of Massachusetts, Amherst, Technical Report 07-49, October, 2007.</li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h3>5.9.2. Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../auto_examples/applications/face_recognition.html#example-applications-face-recognition-py"><em>Faces recognition example using eigenfaces and SVMs</em></a></p>
</div>
</div>
<div class="section" id="forest-covertypes">
<span id="covtype"></span><h2>5.10. Forest covertypes<a class="headerlink" href="#forest-covertypes" title="Permalink to this headline">¶</a></h2>
<p>The samples in this dataset correspond to 30×30m patches of forest in the US,
collected for the task of predicting each patch&#8217;s cover type,
i.e. the dominant species of tree.
There are seven covertypes, making this a multiclass classification problem.
Each sample has 54 features, described on the
<a class="reference external" href="http://archive.ics.uci.edu/ml/datasets/Covertype">dataset&#8217;s homepage</a>.
Some of the features are boolean indicators,
while others are discrete or continuous measurements.</p>
<p><a class="reference internal" href="../modules/generated/sklearn.datasets.fetch_covtype.html#sklearn.datasets.fetch_covtype" title="sklearn.datasets.fetch_covtype"><tt class="xref py py-func docutils literal"><span class="pre">sklearn.datasets.fetch_covtype</span></tt></a> will load the covertype dataset;
it returns a dictionary-like object
with the feature matrix in the <tt class="docutils literal"><span class="pre">data</span></tt> member
and the target values in <tt class="docutils literal"><span class="pre">target</span></tt>.
The dataset will be downloaded from the web if necessary.</p>
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer">
        &copy; 2010 - 2014, scikit-learn developers (BSD License).
      <a href="../_sources/datasets/index.txt" rel="nofollow">Show this page source</a>
    </div>
     <div class="rel rellarge">
    
    <div class="buttonPrevious">
      <a href="../documentation.html">Previous
      </a>
    </div>
    <div class="buttonNext">
      <a href="covtype.html">Next
      </a>
    </div>
    <div class="buttonPrevious">
      <a href="../np-modindex.html">Previous
      </a>
    </div>
    <div class="buttonNext">
      <a href="../py-modindex.html">Next
      </a>
    </div>
    
     </div>

    
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-22606712-2']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    

    <script src="http://www.google.com/jsapi" type="text/javascript"></script>
    <script type="text/javascript"> google.load('search', '1',
        {language : 'en'}); google.setOnLoadCallback(function() {
            var customSearchControl = new
            google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
            customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
            var options = new google.search.DrawOptions();
            options.setAutoComplete(true);
            customSearchControl.draw('cse', options); }, true);
    </script>
  </body>
</html>